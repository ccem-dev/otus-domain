"use strict";!function(){function e(){window.i18next.use(window.i18nextBrowserLanguageDetector).use(window.i18nextXHRBackend),window.i18next.init({fallbackLng:"dev",backend:{loadPath:"app/i18n/locales/pt-BR/translation.json"}},function(e,t){e&&console.log(e)})}angular.module("otusDomain",["dependencies","otusjs","otusDomain.dashboard","otusDomain.rest","otusDomain.authenticator","otusDomain.installer","otusDomain.repository","otusDomain.project","otusDomain.project.fieldCenter","otusDomain.project.configuration","otusDomain.project.datasource","otus.domain.client","otus.client","otusDomain.user","otusDomain.utils","ngMaterial","ngSanitize","md.data.table","jm.i18next"]).run(e),e.$inject=[]}(),function(){angular.module("otusDomain.authenticator",[])}(),function(){angular.module("dependencies",["ngMaterial","ngMessages","ngAnimate","ui.mask","ui.router","colorpicker.module"])}(),function(){window.__env=window.__env||{},window.__env.apiUrl="${API_URL}"}(),function(){function e(e,t,n){var o=t.__env;e.setUrl(o.apiUrl),n.reloadLoggedUser()}angular.module("otusDomain").run(["RestResourceService","$window","UserService",e])}(),function(){function e(e){e.formatDate=function(e){return moment(e).format("DD/MM/YYYY")},e.parseDate=function(e){var t=moment(e,"DD/MM/YYYY",!0);return t.isValid()?t.toDate():new Date(NaN)}}angular.module("otusDomain").config(["$mdDateLocaleProvider",e])}(),function(){function e(e){e.errorOnUnhandledRejections(!1)}angular.module("otusDomain").config(e),e.$inject=["$qProvider"]}(),function(){function e(e,t,n,o,r,i,a){function s(){var e=n.defer();return a.isLogged()?e.resolve():e.reject({redirectTo:i.LOGIN}),e.promise}function c(){var e=n.defer();return a.isLogged()?e.reject({redirectTo:i.HOME}):e.resolve(),e.promise}function u(){var e=n.defer();return o.hasProject()?e.resolve():e.reject({redirectTo:i.HOME}),e.promise}function l(){var e=n.defer(),t=a.getInstallerResource();return t.ready(function(t){t.data?e.resolve():e.reject({redirectTo:i.INSTALLER})}),e.promise}function d(){var e=n.defer(),t=a.getInstallerResource();return t.ready(function(t){t.data?e.reject({redirectTo:i.LOGIN}):e.resolve()}),e.promise}var f=this;f.loggedUser=s,f.alreadyLogged=c,f.selectedProject=u,f.initialConfiguration=l,f.onlyOneConfiguration=d,t.$on("$stateChangeError",function(t,n,o,r,i,a){t.preventDefault(),a.redirectTo?e.go(a.redirectTo):e.go("error",{status:a.status})})}angular.module("otusDomain").service("RouteRulesResolver",e),e.$inject=["$state","$rootScope","$q","ProjectContext","DashboardStateService","APP_STATE","RestResourceService"]}(),function(){function e(e,t){var n="app/dashboard/menu/dashboard-menu.html",o="app/dashboard/template/main-dashboard-template.html";e.state("installer",{url:"/installer",resolve:{onlyOneConfiguration:function(e){return e.onlyOneConfiguration()}},views:{"system-wrap":{templateUrl:"app/installer/initial/initial-config.html",controller:"InitialConfigController as initialConfigController"},"repository-config@installer":{templateUrl:"app/survey-repository/repository.html",controller:"InitialConfigController as initialConfigController"}}}).state("login",{url:"/login",resolve:{loggedUser:function(e){return e.alreadyLogged()},initialConfiguration:function(e){return e.initialConfiguration()}},views:{"system-wrap":{templateUrl:"app/authenticator/login/login.html",controller:"LoginController",controllerAs:"loginController"}}}).state("user-register",{url:"/user/register",resolve:{initialConfiguration:function(e){return e.initialConfiguration()}},views:{"system-wrap":{templateUrl:"app/user/management/registry/user-register.html",controller:"UserRegisterController",controllerAs:"userRegisterController"}}}).state("user-activation",{url:"/user/activation",resolve:{loggedUser:function(e){return e.loggedUser()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@user-activation":{templateUrl:n},"system-content@user-activation":{templateUrl:"app/user/management/activation/user-activation.html",controller:"UserActivationController",controllerAs:"$ctrl"}}}).state("user-otus-management",{url:"/project/user",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e,t){e.initialize(),t.initialize()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@user-otus-management":{templateUrl:n},"system-content@user-otus-management":{template:"<otus-user-dashboard></otus-user-dashboard>"}}}).state("field-center",{url:"/project/centers",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},loadCenters:function(e){e.loadCenters()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@field-center":{templateUrl:n},"system-content@field-center":{templateUrl:"app/project/fieldCenter/field-center-template.html",controller:"FieldCenterController",controllerAs:"fieldCenterController"}}}).state({name:"activity_configuration",url:"/project/activity_configuration",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e,t){e.initialize(),t.initialize()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@activity_configuration":{templateUrl:n},"system-content@activity_configuration":{template:"<activity-configuration flex></activity-configuration>"}}}).state({name:"activity_settings",url:"/project/activity_configuration/settings",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e,t){e.initialize(),t.initialize()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@activity_settings":{templateUrl:n},"system-content@activity_settings":{template:'<activity-settings flex="80"></activity-settings>'}}}).state({name:"report_manager",url:"/project/report_manager",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e){e.initialize()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@report_manager":{templateUrl:n},"system-content@report_manager":{template:"<report-manager flex></report-manager>"}}}).state({name:"datasource_manager",url:"/project/datasource_manager",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e){e.initialize()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@datasource_manager":{templateUrl:n},"system-content@datasource_manager":{template:"<datasource-manager flex></datasource-manager>"}}}).state("home",{url:"/home",resolve:{loggedUser:function(e){return e.loggedUser()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@home":{templateUrl:n},"system-content@home":{templateUrl:"app/dashboard/template/dashboard-content-template.html"},"section-info@home":{templateUrl:"app/dashboard/home/home-info-section.html"},"section-view@home":{templateUrl:"app/dashboard/home/home-view-section.html"},"section-commands@home":{templateUrl:"app/dashboard/home/home-commands-section.html"}}}).state("configuration-center",{url:"/project/configuration",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e,t){e.initialize(),t.initialize()}},views:{"system-wrap":{templateUrl:o,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@configuration-center":{templateUrl:n},"system-content@configuration-center":{templateUrl:"app/project/configuration/configuration-template.html",controller:"otusjs.otus-domain.project.configuration.ProjectConfigurationController",controllerAs:"configController"}}}).state("offline",{url:"/offline",views:{"system-wrap":{templateUrl:"app/response-error/offline/offline.html",controller:"ResponseErrorOfflineController as controller"}}}),t.otherwise("/login")}angular.module("otusDomain").config(["$stateProvider","$urlRouterProvider",e]).constant("APP_STATE",{LOGIN:"login",USER_REGISTER:"user-register",INSTALLER:"installer",HOME:"home",USER_ACTIVATION:"user-activation",USER_ACTIVATION_IN_PROJECT:"user-otus-management",PROJECT_CENTER:"field-center",PROJECT_ACTIVITY_CONFIGURATION:"activity_configuration",ACTIVITY_SETTINGS:"activity_settings",ERROR_OFFLINE:"offline",PROJECT_CONFIGURATION:"configuration-center",DATASOURCE_MANAGER:"datasource_manager",REPORT_MANAGER:"report_manager"}),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function e(e,t){e.theme("layoutTheme").primaryPalette("blue",{"default":"A200","hue-1":"200"}).accentPalette("blue-grey",{"default":"900","hue-1":"50"}).warnPalette("red"),t.defaultIconSet("app/assets/img/icons/mdi.svg",24)}angular.module("otusDomain").config(["$mdThemingProvider","$mdIconProvider",e])}(),function(){angular.module("otusDomain.dashboard",[])}(),function(){angular.module("otusDomain.installer",["passwordControl"])}(),function(){angular.module("otusDomain.project",[])}(),function(){angular.module("otusDomain.rest",[])}(),function(){angular.module("otusDomain.repository",[])}(),function(){angular.module("otusDomain.user",["otusDomain.user.management"])}(),function(){function e(e,t,n,o,r){var i="Login Inválido! Verifique os dados informados.";e.authenticate=function(e){r.authenticate(e).then(function(){t.goToHome()},function(){o.show(o.simple().textContent(i))})},e.register=function(){t.goToUserRegister()}}angular.module("otusDomain.authenticator").controller("LoginController",e),e.$inject=["$scope","DashboardStateService","RestResourceService","$mdToast","UserService"]}(),angular.module("passwordControl",[]).directive("stPassword",function(){return{require:"ngModel",restrict:"A",link:function(e,t,n,o){var r=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])/;e.$watch(function(){return o.$modelValue},function(e){r.test(e)&&e.length>=6&&e.length<=32?o.$setValidity("passwordPattern",!0):o.$setValidity("passwordPattern",!1)})}}}).directive("stPasswordMatch",function(){return{require:"ngModel",restrict:"A",scope:{stPasswordMatch:"="},link:function(e,t,n,o){function r(e,t){e!==t?o.$setValidity("passwordMatch",!1):o.$setValidity("passwordMatch",!0)}e.$watch(function(){return e.stPasswordMatch},function(e){r(e,o.$modelValue)}),e.$watch(function(){return o.$modelValue},function(t){r(e.stPasswordMatch,t)})}}}),function(){var e=angular.module("otusDomain.utils",[]);e.service("StringNormalizer",[function(){function e(e){for(var t=e.indexOf("-")!==-1?"-":".",n=e.split(t),o=n.length,r=n[0].toLowerCase(),i=1;i<o;i++){var a=n[i].slice(0,1),s=n[i].slice(1);r=r.concat(a.toUpperCase().concat(s.toLowerCase()))}return r}var t=this;t.normalizeString=e}])}(),function(){function e(e,t,n,o,r){function i(){C.currentState="Login"}function a(){C.currentState="Login",e.go(n.LOGIN)}function s(){C.currentState="Instalador do Sistema",e.go(n.INSTALLER)}function c(){C.currentState="Cadastro de Usuário",e.go(n.USER_REGISTER)}function u(){C.currentState="Home",e.go(n.HOME)}function l(){C.currentState="Liberação de Usuários",e.go(n.USER_ACTIVATION)}function d(){C.currentState="Liberação de usuários no projeto selecionado",e.go(n.USER_ACTIVATION_IN_PROJECT)}function f(){C.currentState="Centros",e.go(n.PROJECT_CENTER)}function m(){C.currentState="Configurações de atividades",e.go(n.PROJECT_ACTIVITY_CONFIGURATION)}function p(){C.currentState="Configuração de atividade",e.go(n.ACTIVITY_SETTINGS)}function v(){C.currentState="Gerenciador de relatórios",e.go(n.REPORT_MANAGER)}function g(){C.currentState="Gerenciador de dados",e.go(n.DATASOURCE_MANAGER)}function h(){C.currentState="Configurações de Projeto",e.go(n.PROJECT_CONFIGURATION)}function y(){C.currentState="Offline",e.go(n.ERROR_OFFLINE)}function S(){var e=o.getAuthenticatorResource();e.invalidate(function(){o.removeSecurityToken(),r.removeSecurityToken(),a()})}var C=this;C.goToLogin=a,C.goToHome=u,C.goToInstaller=s,C.goToUserRegister=c,C.goToUserActivation=l,C.goToUserActivationInProject=d,C.goToProjectCenters=f,C.goToProjectConfiguration=h,C.goToErrorOffline=y,C.goToProjectActivityConfiguration=m,C.goToActivitySettings=p,C.goToProjectReportManager=v,C.goToProjectDatasourceManager=g,C.logout=S,i()}angular.module("otusDomain.dashboard").service("DashboardStateService",e),e.$inject=["$state","$http","APP_STATE","RestResourceService","OtusRestResourceService"]}(),function(){function e(){}angular.module("otusDomain.dashboard").controller("HomeController",e),e.$inject=[]}(),function(){function e(e,t,n,o,r){function i(){return t.currentState}function a(){n("left").toggle()}function s(){n("left").close()}function c(){t.goToHome(),s()}function u(){t.goToUserActivation(),s()}function l(){t.goToUserActivationInProject(),s()}function d(){t.goToProjectActivityConfiguration(),s()}function f(){t.goToProjectReportManager(),s()}function m(){t.goToProjectDatasourceManager(),s()}function p(){t.goToProjectCenters(),s()}function v(){t.goToProjectConfiguration(),s()}function g(){e.showDialog().onConfirm(t.logout)}var h=this;h.getSelectedSystemArea=i,h.open=a,h.close=s,h.openHome=c,h.openUserActivation=u,h.logout=g,h.openProjectCenters=p,h.openUserActivationInProject=l,h.openProjectConfiguration=v,h.openProjectActivityConfiguration=d,h.openReportManager=f,h.openDatasourceManager=m}angular.module("otusDomain.dashboard").controller("DashboardMenuController",e),e.$inject=["LogoutDialogService","DashboardStateService","$mdSidenav","ProjectSelectionService","ProjectContext"]}(),function(){function e(e,t,n,o,r,i){function a(){g=i.getRepositoryResource(),h=i.getInstallerResource()}function s(e){n.isLoading=!0,h.config(e,function(e){e.data?u():c(e.MESSAGE),n.isLoading=!1})}function c(e){t.show(t.simple().textContent(S))}function u(){var e=o.alert().title("Informação").content(y).ok("ok");o.show(e)["finally"](function(){r.goToLogin()})}function l(e){h.validationEmail(e,function(e){m(e.data)})}function d(e){g.validateCredentials(e,function(e){p(e.data)})}function f(e){g.validateConnection(e,function(e){v(e.data)})}function m(e){n.initialConfigSystemForm.emailSenderEmail.$setValidity("emailService",e),n.initialConfigSystemForm.$setValidity("emailService",e)}function p(e){n.initialConfigSystemForm.repositoryUsername.$setValidity("credentials",e),n.initialConfigSystemForm.repositoryPassword.$setValidity("credentials",e),n.initialConfigSystemForm.$setValidity("credentials",e)}function v(e){n.initialConfigSystemForm.repositoryHost.$setValidity("connection",e),n.initialConfigSystemForm.repositoryPort.$setValidity("connection",e),n.initialConfigSystemForm.$setValidity("credentials",e)}self=this;var g,h,y="Seu cadastro foi realizado com sucesso! Você vai ser redirecionado para a tela de login.",S="Houve um erro ao instalar seu projeto. Verifique os dados informados";self.register=s,self.validateEmailService=l,self.validateCredentials=d,self.validateRepositoryConnection=f,self.validateEmailService=l,a()}angular.module("otusDomain.installer").controller("InitialConfigController",e),e.$inject=["$q","$mdToast","$scope","$mdDialog","DashboardStateService","RestResourceService"]}(),function(){angular.module("otusDomain.project.configuration",[])}(),function(){function e(e){}angular.module("otusDomain.project.configuration").controller("otusjs.otus-domain.project.configuration.ProjectConfigurationController",e),e.$inject=["otusDomain.rest.configuration.ProjectConfigurationService"]}(),function(){function e(){function e(e){return new t(e)}var n=this;return n.create=e,n}function t(e){function t(e){Object.assign(n,o,e)}var n=this,o=Object.freeze({id:void 0,name:void 0,data:void 0});return t(e),n}angular.module("otusDomain.project.datasource").factory("DatasourceFactory",e)}(),function(){function e(e,t,n){function o(){S.newDatasourceName="",a()}function r(){S.loadFile=!S.loadFile}function i(){return S.loadFile}function a(){e.getDatasourceList().then(function(e){S.ready=!0,S.datasources=e,0===S.datasources.length&&h("Nenhuma fonte de dados adicionado.")})["catch"](function(e){h("Ocorreu um erro. Tente novamente mais tarde.")})}function s(e){e.type.match("csv")?S.isUpdate?c(e):(u(e),$("#newDatasourceName").focus()):h("Arquivo incompatível, o formato do arquivo deve ser csv.")}function c(n){S.isUpdate=!1;var o=new FormData;o.append("file",n),o.append("delimiter",y),o.append("id",S.id),o.append("name",S.name),e.updateDatasource(o).then(function(e){if(e.data)h("Dados salvo com sucesso.");else if(e.MESSAGE.includes("same"))h("Fonte de dados já existente, você tem a opção de editar caso desejar.");else if(e.MESSAGE.includes("missing"))h("Não foi possível atualizar a fonte de dados. Há elementos ausentes em comparação ao arquivo anterior.");else if(e.MESSAGE.includes("Data Validation Fail: ID")){var n=t.alert().title("Não foi possível salvar o datasource").content("Entre em contato com o suporte").ok("ok");t.show(n)}a()})["catch"](function(e){h("Não foi possível salvar o datasource: "+e)})}function u(e){S.newDatasourceFile=e}function l(e){var t=event.keyCode,n=t>=97&&t<=122,o=t>=65&&t<=90,r=t>=48&&t<=57,i=95===t;n||o||r||i||e.preventDefault()}function d(){S.insertingNewDatasource=!0}function f(){delete S.newDatasourceFile,delete S.insertingNewDatasource}function m(){var n=new FormData;S.createFileName=S.newDatasourceName.replace(/\.csv/gi,"").replace(/ \([0-9]\)/gi,""),n.append("file",S.newDatasourceFile),n.append("delimiter",y),n.append("id",S.createFileName.toLowerCase()),n.append("name",S.createFileName.toUpperCase()),e.createDatasource(n).then(function(e){if(e.data)h("Dados salvo com sucesso.");else if(e.MESSAGE)if(e.MESSAGE.match("duplicated")){var n="";e.CONTENT.forEach(function(e){if(e.match("extraction")){var t=e.split(":");n=n.concat("Valor de extração: "+t[1].concat(" <br> "))}if(e.match("value")){var o=e.split(":");n=n.concat("Valor: "+o[1].concat(" <br> "))}});var o=t.alert().title("Existem elementos duplicados na fonte de dados: ").htmlContent(n).ok("ok");t.show(o).then(function(){})}else h("Fonte de dados já existente.");p(),a()})["catch"](function(e){h("Não foi possível salvar o datasource: "+e),p()})}function p(){S.newDatasourceFile=null,S.insertingNewDatasource=!1,S.newDatasourceName=""}function v(e){S.id=e.id,S.name=e.name,S.isUpdate=!0}function g(e){var t=e.name;alasql('SELECT * INTO CSV("'+t+'.csv",{headers:false}) FROM ?',[e.data])}function h(e){n.show(n.simple().textContent(e).position("bottom left").hideDelay(3e3))}var y=";",S=this;S.ready=!1,S.loadFile=!1,S.isLoading=i,S.$onInit=o,S.exportDatasource=g,S.saveNewDatasource=m,S.updateAction=v,S.newDatasourceAction=d,S.datasourceNameFilter=l,S.cancelUpload=f,S.initLoadFile=r,S.isUpdate=!1,S.datasources=[],S.action={callback:s,type:".csv",loading:S.initLoadFile}}angular.module("otusDomain.project.datasource").component("datasourceManager",{controller:"datasourceManagerController as $ctrl",templateUrl:"app/project/datasource/datasource-manager-template.html"}).controller("datasourceManagerController",e),e.$inject=["DatasourceManagerService","$mdDialog","$mdToast"]}(),function(){function e(e,t,n){function o(){e.initialize()}function r(){return e.list().then(function(e){var n=e.data.data;return n.map(function(e){return t.create(e)})})["catch"](function(e){throw e})}function i(t){return e.update(t).then(function(e){return e.data?e.data:n.reject(e.MESSAGE)})["catch"](function(e){return n.reject(e)})}function a(t){return e.create(t).then(function(e){return e.data?e.data:n.reject(e.MESSAGE)})["catch"](function(e){return n.reject(e)})}var s=this;s.getDatasourceList=r,s.updateDatasource=i,s.createDatasource=a,o()}angular.module("otusDomain.project.datasource").service("DatasourceManagerService",e),e.$inject=["DatasourceRestService","DatasourceFactory","$q"]}(),function(){angular.module("otusDomain.project.datasource",[])}(),function(){function e(e){function t(e){return i.enableExtraction(e).$promise}function n(e){return i.disableExtraction(e).$promise}function o(e){return i.updateExtractionIps(e).$promise}var r=this,i=e.getExtractionResource();r.enableExtraction=t,r.disableExtraction=n,r.updateExtractionIps=o}angular.module("otusDomain.project").service("ExtractionRestService",e),e.$inject=["OtusRestResourceService"]}(),function(){function e(){function e(e){t.fieldCenters=e}var t=this;t.fieldCenters=[],t.setFieldCenters=e}angular.module("otusDomain.project.fieldCenter").service("ProjectFieldCenterContext",e)}(),function(){function e(e,t,n){function o(){u.showAddCenterTab=!1}function r(){return e.getCenters()}function i(e){e.editMode=!e.editMode}function a(e){u.showAddCenterTab=e}function s(t){e.update(t,function(e){e.hasErrors||n.show(n.simple().textContent(c))})}var c="Centro atualizado",u=this;u.centerAddAling="center center",u.centerAddheaderLabel="Novo Centro",u.getAllCenters=r,u.edit=i,u.update=s,u.showCreationTab=a,u.$onInit=o}angular.module("otusDomain.project.fieldCenter").controller("FieldCenterController",e),e.$inject=["ProjectFieldCenterService","$mdDialog","$mdToast"]}(),function(){angular.module("otusDomain.project.fieldCenter",[])}(),function(){function e(e,t){function n(){return t.fieldCenters}function o(){var n=e.getOtusFieldCenterResource();n.getAll(function(e){t.setFieldCenters(e.data)},function(){t.setFieldCenters([])})}function r(t,n){var o=e.getOtusFieldCenterResource();o.create(t,function(e){n(e)})}function i(t,n){delete t.editMode;var r=e.getOtusFieldCenterResource();r.update(t,function(e){o(),n(e)})}var a=this;a.loadCenters=o,a.getCenters=n,a.create=r,a.update=i}angular.module("otusDomain.project.fieldCenter").service("ProjectFieldCenterService",e),e.$inject=["OtusRestResourceService","ProjectFieldCenterContext"]}(),function(){function e(){function e(){t.title=t.title||"",t.align=t.align||"center end",t.colorLeft=t.colorLeft||"#0092F8",t.colorRight=t.colorRight||"#4db5ff"}var t=this;t.$onInit=e}angular.module("otusDomain.project").component("otusPainel",{controller:e,templateUrl:"app/project/otus-painel/otus-painel-template.html",bindings:{headerLabel:"<",colorLeft:"<",colorRight:"<",align:"<"},transclude:!0})}(),function(){function e(e,t,n,o){function r(){C.selectedUser=null,h=e.getUserResource(),y=e.getOtusFieldCenterResource(),S=t.create(h),a()}function i(){var e=n('<users-statistical-data users="$ctrl.allUsers" layout-align="start space-between" ng-if="$ctrl.allUsers" flex></users-statistical-data>')(o),t=angular.element(document.getElementById("statisticComponent"));t.html(""),t.append(e)}function a(){S.list().then(function(e){C.allUsers=e.data,i(),c(),C.filterUsers()})["catch"](function(e){console.error(e)})}function s(){S.list().then(function(e){C.allUsers=e.data,C.filterUsersActives(),i()})}function c(){y.getAll(function(e){C.fieldCenters=e.data})}function u(){C.activeUsers?C.users=angular.copy(C.allUsers.filter(function(e){return 1==e.enable})):C.users=angular.copy(C.allUsers),C.filterUsersCenter()}function l(){C.selectCenter=C.fieldCenters.find(function(e){return e.acronym===C.userCenter}),C.selectCenter&&(C.users=angular.copy(C.users.filter(function(e){return e.fieldCenter.acronym==C.userCenter}))),C.filterUsersExtraction()}function d(){C.extractionUsers&&(C.users=angular.copy(C.users.filter(function(e){return 1==e.extraction})))}function f(){m(),C.activeUsers||C.extractionUsers||C.selectCenter||(C.users=angular.copy(C.allUsers)),C.filterUsersActives()}function m(){C.searchText="",delete C.selectedUser}function p(e){delete C.selectedUser,C.selectedUser=e}function v(e){return e?C.users.filter(g(e)):C.users}function g(e){var t=e.toLowerCase();return function(e){return e.name.toLowerCase().indexOf(t)>=0||e.email.toLowerCase().indexOf(t)>=0||e.surname.toLowerCase().indexOf(t)>=0}}var h,y,S,C=this;C.users=[],C.fieldCenters=[],C.activeUsers=!0,C.extractionUsers=!1,C.userCenter="",C.$onInit=r,C.selectedUserChange=p,C.searchUser=v,C.filterUsersActives=u,C.filterUsersExtraction=d,C.filterUsersCenter=l,C.filterUsers=f,C.updateUsers=s}angular.module("otusDomain.project").component("otusUserDashboard",{templateUrl:"app/project/otus-user/otus-user-dashboard-template.html",controller:"otusUserCtrl as $ctrl"}).controller("otusUserCtrl",e),e.$inject=["OtusRestResourceService","UserManagerFactory","$compile","$scope"]}(),function(){function e(){function e(e){return new t(e)}var n=this;return n.create=e,n}function t(e){function t(t){return e.enable(t).$promise}function n(t){return e.disable(t).$promise}function o(){return e.list().$promise}function r(t){return e.updateFieldCenter(t).$promise}var i=this;i.enable=t,i.disable=n,i.list=o,i.updateFieldCenter=r}angular.module("otusDomain.project").factory("UserManagerFactory",e)}(),function(){function e(){function e(e){return new n(e)}function o(e){try{return new n(t(e))}catch(o){throw"Erro ao processar arquivo"}}var r=this;return r.create=e,r.fromHtmlFile=o,r}function t(e){function t(e,t,n){return e.substring(e.lastIndexOf(t)+t.length,e.lastIndexOf(n))}function n(e){var n=t(e,"<otus-datasource>","</otus-datasource>"),o=JSON.parse(n);return o.template=e.replace("<otus-datasource>"+n+"</otus-datasource>",""),o}return n(e)}function n(e){function t(e){Object.assign(s,u,e)}function n(e){c=e,angular.extend(s,e)}function o(){angular.extend(s,c)}function r(){var e={};return Object.keys(c).forEach(function(t){e[t]=s[t]}),e.sendingDate=s.sendingDate?s.sendingDate:new Date,e}function i(){var e={};return Object.keys(u).forEach(function(t){e[t]=s[t]}),e.template="","<otus-datasource>\n"+JSON.stringify(e)+"\n</otus-datasource>"+s.template}function a(){return s._id.$oid}var s=this,c=e,u=Object.freeze({dataSources:void 0,fieldCenter:void 0,label:void 0,template:void 0});return s.sendingDate="",t(e),s.getId=a,s.refresh=n,s.reload=o,s.toJSON=r,s.toHtml=i,s}angular.module("otusDomain.dashboard").factory("ReportFactory",e)}(),function(){angular.module("otusDomain.dashboard").component("reportManager",{controller:"reportManagerController as $ctrl",templateUrl:"app/project/report/report-manager-template.html"})}(),function(){function e(e,t,n,o){function r(){y=n.getOtusFieldCenterResource(),m(),e.getReportList().then(function(e){S.ready=!0,S.reports=e,l()})["catch"](function(e){S.error=!0})}function i(){S.reports=null}function a(t){e.uploadReport(t).then(function(e){S.reports.push(e),l(),g("Relatório salvo com sucesso.")})["catch"](function(e){g("Não foi possível salvar o relatório: "+e)})}function s(n){t.show(v()).then(function(){e.updateReport(n).then(function(e){l(),g("Relatório alterado com sucesso.")})["catch"](function(e){g("Erro ao atualizar: "+e)})})["catch"](function(){n.reload(),g("Relatório não alterado!")})}function c(n,o){t.show(p()).then(function(){e.deleteReport(n).then(function(e){e&&S.reports.splice(o,1),l(),g("Relatório excluído com sucesso.")})["catch"](function(e){g("Erro ao excluir: "+e)})})["catch"](function(){d(),g("Relatório não excluído!!")})}function u(e){f("report.html",e.toHtml())}function l(){S.reportsOld=angular.copy(S.reports)}function d(){S.reports=angular.copy(S.reportsOld)}function f(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function m(){y.getAll(function(e){S.fieldCenters=e.data})}function p(){return h=t.confirm().title("Exclusão de Relatório").textContent("Você tem certeza que deseja excluir esse Relatório?").ariaLabel("exclusão de relatório").ok("Sim").cancel("Não")}function v(){return h=t.confirm().title("Atualizar Relatório").textContent("Você tem certeza que deseja atualizar esse Relatório?").ariaLabel("atualização de relatório").ok("Sim").cancel("Não")}function g(e){o.show(o.simple().textContent(e).position("bottom left").hideDelay(3e3))}var h,y,S=this;S.ready=!1,S.error=!1,S.reports=[],S.reportsOld=[],S.uploadReport={callback:a,type:".html"},S.$onInit=r,S.$onDestroy=i,S.updateReport=s,S.deleteReport=c,S.exportReport=u}angular.module("otusDomain.dashboard").controller("reportManagerController",e),e.$inject=["ReportManagerService","$mdDialog","OtusRestResourceService","$mdToast"]}(),function(){function e(e,t,n){function o(){e.initialize()}function r(){return e.list().then(function(e){var n=e.data;return n.map(function(e){return t.create(e)})})["catch"](function(e){throw e})}function i(o){try{var r=t.fromHtmlFile(o)}catch(i){return n.reject(i)}return e.create(r).then(function(e){return e.data?(r.refresh(e.data),r):n.reject(e.MESSAGE)})["catch"](function(e){return n.reject(e)})}function a(t){return e.update(t).then(function(e){return e.data?(t.refresh(e.data),e.data):n.reject(e.MESSAGE)})["catch"](function(e){return n.reject(e)})}function s(t){return e.remove(t.getId()).then(function(e){return e.data?e.data:n.reject(e.MESSAGE)})["catch"](function(e){return n.reject(e)})}var c=this;c.getReportList=r,c.uploadReport=i,c.updateReport=a,c.deleteReport=s,o()}angular.module("otusDomain.dashboard").service("ReportManagerService",e),e.$inject=["ReportRestService","ReportFactory","$q"]}(),function(){function e(e,t){function n(){d=[]}function o(e){l=e,c()}function r(){return l}function i(){return null!==l}function a(o){n();var r=e.getOtusProjectResource();r.list(function(e){e.data.forEach(function(e,n,o){var r=e.projectName,i=e.projectRestUrl,a=e.projectToken,s=t.create(r,i,a);d.push(s)}),o(d)})}function s(e){f.push(e)}function c(){f.forEach(function(e){e(l)})}var u=this,l=null,d=[],f=[];u.setProject=o,u.hasProject=i,u.getCurrentProject=r,u.loadProjects=a,u.registerObserver=s}angular.module("otusDomain.project").service("ProjectContext",e),e.$inject=["RestResourceService","ProjectFactory"]}(),function(){function e(e,t,n){function o(t){e.setUrl(t.url);var n=e.getOtusInstallerResource();n.ready(function(e){e.data?t.online():t.offline()},function(){t.offline()})}function r(n){var o=t.defer();e.setUrl(n.url);var r=n.getAuthentication(),i=e.getOtusAuthenticatorResource();return i.authenticateProject(r,function(e){e.data?o.resolve(e):o.reject(e)}),o.promise}var i=this;i.isOnline=o,i.authenticate=r}angular.module("otusDomain.project").service("ProjectSecurityService",e),e.$inject=["OtusRestResourceService","$q","ProjectContext"]}(),function(){function e(e,t){function n(){e.hasProject()||o()}function o(){e.loadProjects(function(e){r(e)})}function r(e){t.show({controller:"ProjectChooseController as projectChoose",templateUrl:"app/project/selection/ui/dialog/project-choose-template.html",parent:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0,locals:{projects:e}})}var i=this;i.choose=o,i.initialChoose=n}angular.module("otusDomain.project").service("ProjectSelectionService",e),e.$inject=["ProjectContext","$mdDialog"]}(),function(){function e(e){function t(){a=e.getRepositoryResource()}function n(e){a.create(e,function(e){return!e.data.hasError})}function o(e){a.validateConnection(e,function(e){return e.data})}function r(e){a.getByRepositoryName({repositoryName:e.name},function(e){return e.data})}function i(e){a.validateCredentials(e,function(e){return e.data})}var a,s=this;s.createRepository=n,s.validateRepositoryConnection=o,s.validateIfRepositoryAlreadyExists=r,s.validateRepositoryCredentials=i,t()}angular.module("otusDomain.repository").service("RepositoryService",e),e.$inject=["RestResourceService"]}(),function(){function e(e){e.interceptors.push("otusDomain.ResponseInterceptor")}angular.module("otusDomain").config(["$httpProvider",e])}(),function(){function e(e){function t(t){e.get("DashboardStateService");return t}var n=this;return n.responseError=t,n}angular.module("otusDomain").factory("otusDomain.ResponseInterceptor",e),e.$inject=["$injector"]}(),function(){function e(e){function t(){
e.goToLogin()}var n=this;n.tryAgain=t}angular.module("otusDomain").controller("ResponseErrorOfflineController",e),e.$inject=["DashboardStateService"]}(),function(){function e(e,t,n,o){function r(t){var o=n.defer(),r=e.getAuthenticatorResource();return r.authenticate(t,function(e){e.data?(s(e.data),o.resolve()):o.reject()}),o.promise}function i(){var t=n.defer(),o=e.getAuthenticatorResource();return o.invalidate(function(){c(),t.resolve()},function(){t.reject()}),t.promise}function a(){o.reloadCurrentUser()}function s(t){e.setSecurityToken(t.token),o.setCurrentUser(t)}function c(){o.removeCurrentUser(),e.removeSecurityToken(),t.removeSecurityToken()}function u(){return o.getCurrentUser()}var l=this;l.getLoggedUser=u,l.authenticate=r,l.logout=i,l.reloadLoggedUser=a}angular.module("otusDomain.user").service("UserService",e),e.$inject=["RestResourceService","OtusRestResourceService","$q","UserContext"]}(),function(){function e(e){function t(){i.currentUser=null}function n(e){i.currentUser=e}function o(){return i.currentUser}function r(){if(e.isLogged()){var t=e.getUserResource();t.current(function(e){n(e.data)})}}var i=this;i.currentUser=null,i.setCurrentUser=n,i.getCurrentUser=o,i.reloadCurrentUser=r,i.removeCurrentUser=t}angular.module("otusDomain.user").service("UserContext",e),e.$inject=["RestResourceService"]}(),function(){angular.module("otusDomain.user.management",["passwordControl"])}(),function(){function e(){function e(){p.loading_screen=null,a()}function t(e,t){var n=d+p.key;(e||t)&&(n+=" - "+t+e)}function n(e){p.key&&p.key!==e?t(e,f):(p.key=e,r())}function o(e){p.key===e?(p.key="",i()):t(e,m)}function r(){p.loading_screen||s()}function i(){p.key?t():p.loading_screen&&(p.loading_screen.finish(),p.loading_screen=null,a())}function a(e){p.message=void 0!==e?e:l}function s(){p.loading_screen=pleaseWait({logo:c,backgroundColor:u,loadingHtml:"<p class='loading-message' style='color:#000;'>"+p.message+"</p><div class='sk-circle'><div class='sk-circle1 sk-child'></div><div class='sk-circle2 sk-child'></div><div class='sk-circle3 sk-child'></div><div class='sk-circle4 sk-child'></div><div class='sk-circle5 sk-child'></div><div class='sk-circle6 sk-child'></div><div class='sk-circle7 sk-child'></div><div class='sk-circle8 sk-child'></div><div class='sk-circle9 sk-child'></div><div class='sk-circle10 sk-child'></div><div class='sk-circle11 sk-child'></div><div class='sk-circle12 sk-child'></div></div>"})}var c="app/assets/img/coruja_neutra_110px.png",u="#b4d0ff",l="Por favor, aguarde o carregamento.",d="Loading bloqueado pela chave: ",f="Não foi possível atribuir a nova chave: ",m="Não foi possível encerrar o loading com a chave: ",p=this;p.key="",p.$onInit=e,p.start=r,p.finish=i,p.startingLockedByKey=n,p.finishUnlockedByKey=o,p.changeMessage=a,e()}angular.module("otusDomain").service("otusDomain.LoadingScreenService",e),e.$inject=[]}(),function(){function e(e){function n(){a.dialogSettings={parent:angular.element(document.body),templateUrl:"app/dashboard/dialog/logout/logout-dialog.html",controller:t,controllerAs:"controller",openFrom:"#system-toolbar",closeTo:{bottom:0}}}function o(){return e.show(a.dialogSettings).then(r,i),{onConfirm:function(e){a.callback=e}}}function r(e){"confirm"===e.action&&a.callback&&a.callback(e.data)}function i(e){}var a=this;a.showDialog=o,n()}function t(e){function t(t){e.hide(t)}function n(t){e.hide(t)}var o=this;o.cancel=t,o.confirm=n}angular.module("otusDomain.dashboard").service("LogoutDialogService",e),e.$inject=["$mdDialog"]}(),function(){angular.module("otusDomain.project").directive("numbersOnly",function(){return{require:"ngModel",link:function(e,t,n,o){function r(e){if(e){var t=String(e),n=t.replace(/[^0-9|\r|\n]/g,"");return n!==t&&(o.$setViewValue(n),o.$render()),String(n)}}o.$parsers.push(r)}}})}(),function(){function e(e,t,n,o,r){function i(){y.groupEditModeStatus=!1,m(),s(),h=n.confirm().title("Exclusão de Formulário").textContent("Você tem certeza que deseja excluir esse Formulário?").ariaLabel("exclusão de formulário").ok("Sim").cancel("Não")}function a(e){y.groupEditModeStatus=e}function s(){o.start(),r.getSurveysManagerConfiguration().then(function(e){y.surveyTemplatesList=e,0===y.surveyTemplatesList.length?y.noListInfo="Nenhum formulário adicionado":y.noListInfo="",o.finish()})["catch"](function(){y.surveyTemplatesList=[],y.noListInfo="Erro de comunicação com servidor",o.finish()})}function c(e){e.forEach(function(t){"json"===e[0].name.split(".")[1]&&u(t).then(function(e){y.uploadedObject=JSON.parse(e),y.uploadedFile=e,y.disableSaving=!1})})}function u(t){var n=e.defer(),o=new FileReader;return o.onload=function(){n.resolve(o.result)},o.readAsText(t),n.promise}function l(e){n.show(h).then(function(){r.deleteSurveyTemplate(y.surveyTemplatesList[e].surveyTemplate.identity.acronym).then(function(){y.surveyTemplatesList.splice(e,1),t.show(t.simple().textContent("Excluído").hideDelay(2e3))})["catch"](function(){t.show(t.simple().textContent("Erro ao excluir").hideDelay(2e3))})},function(){})}function d(e){var n=y.surveyTemplatesList[e].surveyTemplate.identity.acronym,o=y.surveyTemplatesList[e].surveyFormType;r.updateSurveyTemplateType({acronym:n,type:o}).then(function(){t.show(t.simple().textContent("Alterado com sucesso").hideDelay(2e3))})["catch"](function(){t.show(t.simple().textContent("Erro ao alterar.").hideDelay(2e3)),"PROFILE"===o?y.surveyTemplatesList[e].surveyFormType="FORM_INTERVIEW":y.surveyTemplatesList[e].surveyFormType="PROFILE"})}function f(){r.publishTemplate(y.uploadedFile).then(function(e){p(e)})["catch"](function(e){v(e)})}function m(){r.getCollectionOfPermissions().then(function(e){y.permissionList=angular.copy(e)})}function p(e){y.uploadedObject={},y.uploadedFile={},y.disableSaving=!0,y.surveyTemplatesList.push(e),t.show(t.simple().textContent("Upload realizado com sucesso"))}function v(e){var n="";switch(e){case"Acronym Already Exists":n+="Já existe um formulário com esta sigla";break;case"ID Already Exists":n+="Ids de questões conflitam com as de formulários já existentes";break;default:n+="Erro ao enviar"}t.show(t.simple().textContent(n).hideDelay(2e3))}function g(e){return e%2==0?"#efefef":"#ffffff"}var h,y=this;y.$onInit=i,y.surveyTemplatesList=[],y.permissionList=[],y.usersList=[],y.publishTemplate=f,y.updateSurveyFormType=d,y.deleteSurveyTemplate=l,y.groupEditMode=a,y.getColor=g,y.uploadConfig={callback:c,type:"json"},y.uploadedObject={},y.uploadedFile={},y.disableSaving=!0,y.surveyGroupsEditModeMirror=!1}angular.module("otusDomain.dashboard").component("activityConfiguration",{controller:"activityConfigurationCtrl as $ctrl",templateUrl:"app/project/configuration/activity/activity-configuration-template.html"}).controller("activityConfigurationCtrl",e),e.$inject=["$q","$mdToast","$mdDialog","otusDomain.LoadingScreenService","otusDomain.rest.configuration.ProjectConfigurationService"]}(),function(){function e(e,t,n){function o(){r()}function r(){n.getProjectConfiguration().then(function(e){u.participantRegistration=e.participantRegistration,u.autoGenerateRecruitmentNumber=e.autoGenerateRecruitmentNumber})["catch"](function(){u.error=!0,t.show(t.simple().textContent(s).hideDelay(5e3))})}function i(){u.participantRegistration?n.allowNewParticipants(!0).then(function(e){u.participantRegistration=!0,t.show(t.simple().textContent(c).hideDelay(5e3))})["catch"](function(){t.show(t.simple().textContent(s).hideDelay(5e3))}):n.allowNewParticipants(!1).then(function(e){u.participantRegistration=!1,t.show(t.simple().textContent(c).hideDelay(5e3))})["catch"](function(){t.show(t.simple().textContent(s).hideDelay(5e3))})}function a(){u.autoGenerateRecruitmentNumber?n.autoGenerateRecruitmentNumber(!0).then(function(e){u.autoGenerateRecruitmentNumber=!0,t.show(t.simple().textContent(c).hideDelay(5e3))})["catch"](function(){t.show(t.simple().textContent(s).hideDelay(5e3))}):n.autoGenerateRecruitmentNumber(!1).then(function(e){u.autoGenerateRecruitmentNumber=!1,t.show(t.simple().textContent(c).hideDelay(5e3))})["catch"](function(){t.show(t.simple().textContent(s).hideDelay(5e3))})}var s="Erro de comunicação com servidor",c="Alteração realizada com sucesso",u=this;u.participantRegistration,u.autoGenerateRecruitmentNumber,u.error,u.$onInit=o,u.setAllowNewParticipants=i,u.setAutoGenerateRecruitmentNumber=a}angular.module("otusDomain.project.configuration").component("otusParticipantRegistration",{controller:"otusParticipantRegistrationCtrl as $ctrl",templateUrl:"app/project/configuration/participant-registration/participant-registration-template.html"}).controller("otusParticipantRegistrationCtrl",e),e.$inject=["$q","$mdToast","otusDomain.rest.configuration.ProjectConfigurationService"]}(),function(){function e(e){function t(t,n,o){function r(t){var n=e.uploadTypeResolver(t);return""!==n?(i=document.createElement("input"),i.setAttribute("type","file"),i.setAttribute("accept",n)):i=document.createElement("button"),i}var i,a=t.upload,s=a.callback||{},c=a.type||"any";n.on("click",function(e){i=r(c),i.click(),i.addEventListener("change",function(){for(var e=[],t=0;t<this.files.length;t++)e.push(this.files[t]);0!==e.length&&s(e)})})}var n={restrict:"A",link:t,scope:{upload:"="}};return n}angular.module("otusDomain.project.configuration").directive("upload",e),e.$inject=["otusjs.otus-domain.project.configuration.UploadToolService"]}(),function(){function e(){function e(e){var n="";if(e){e=e.replace(/\s/g,"").split(",");for(var o=0;o<e.length;o++){var r=t(e[o]);r&&(n+=r+", ")}}return n||"any"}function t(e){var t={image:"image/*",jpg:".jpg",png:".png",json:".json"};return t[e]}var n=this;n.uploadTypeResolver=e}angular.module("otusDomain.project.configuration").service("otusjs.otus-domain.project.configuration.UploadToolService",e),e.$inject=[]}(),function(){function e(){function e(e,t){function n(){return o=document.createElement("input"),o.setAttribute("type","file"),o.setAttribute("accept",a),o}var o,r=e.datasourceUpload,i=r.callback||{},a=r.type||"any";t.on("click",function(){o=n(),o.click(),o.addEventListener("change",function(t){e.datasourceUpload.loading();for(var n=t.target.files,o=0;o<n.length;o++){var r=n[o];i(r,t)}e.datasourceUpload.loading()})})}var t={restrict:"A",link:e,scope:{datasourceUpload:"="}};return t}angular.module("otusDomain.project.datasource").directive("datasourceUpload",e)}(),function(){function e(e,t,n,o){function r(){m.fieldCenter={},m.fieldCenter.backgroundColor="rgba(54, 162, 235, 1)",m.fieldCenter.borderColor="rgba(54, 162, 235, 1)"}function i(){n.create(m.fieldCenter,function(e){e.CONTENT&&e.CONTENT.valid===!1?(a(m.fieldCenter,e),e.CONTENT.conflicts.forEach(function(e){switch(e){case"acronym":t.createForm.acronym.$setValidity("ACRONYM_EXIST",!1);break;case"code":t.createForm.code.$setValidity("CODE_EXIST",!1)}})):(u(),n.loadCenters(),m.showTab=!1,reset())})}function a(){o.show(o.simple().textContent(f))}function s(){t.createForm.acronym.$setValidity("ACRONYM_EXIST",!0)}function c(){t.createForm.code.$setValidity("CODE_EXIST",!0)}function u(){o.show(o.simple().textContent(d))}function l(){m.fieldCenter=angular.copy({})}var d="Centro Adicionado com Sucesso",f="Dados Invalidos",m=this;m.$onInit=r,m.create=i,m.cleanFields=l,m.resetValidation=s,m.resetValidationCode=c}angular.module("otusDomain.project.fieldCenter").component("centerCard",{controller:e,templateUrl:"app/project/fieldCenter/center-card/center-card-template.html",bindings:{showTab:"="}}),e.$inject=["DashboardStateService","$scope","ProjectFieldCenterService","$mdToast"]}(),function(){function e(e,t,n){function o(){try{a.permission=n.getPermissionByType(t.LABORATORY),a.initialValue=a.permission.access}catch(e){throw a.error=!0,"Erro ao recuperar informações de "+t.LABORATORY}}function r(){n.savePermission(a.permission).then(function(e){i("Permissão de Grupo salva com sucesso."),a.initialValue=a.permission.access})["catch"](function(){i("Não foi possível salvar permissão."),a.permission.access=a.initialValue})}function i(t){e.show(e.simple().textContent(t).position("bottom right").hideDelay(3e3))}var a=this;return a.initialValue=void 0,a.error=!1,a.$onInit=o,a.save=r,a}angular.module("otusDomain.project").component("laboratoryPermission",{templateUrl:"app/project/otus-permission/laboratory/laboratory-permission-template.html",controller:"laboratoryPermissionController as $ctrl"}).controller("laboratoryPermissionController",e),e.$inject=["$mdToast","PERMISSION_LIST","ProjectPermissionService"]}(),function(){angular.module("otusDomain.project").constant("PERMISSION_LIST",{SURVEY_GROUP:"SurveyGroupPermission",LABORATORY:"LaboratoryPermission"})}(),function(){function e(e,t){function n(){i.ready=!1,i.userEmail?t.fetchPermissions(i.userEmail).then(function(e){i.ready=!0})["catch"](function(){r("<h2>Não foi possível carregar as permissões de usuário!</h2><span class='md-caption'>Tente novamente mais tarde.</span>")}):o()}function o(){delete i.managerUserPermission}function r(t){e.show(e.alert().htmlContent(t).ok("OK"))}var i=this;return i.$onInit=n,i.$onDestroy=o,i}angular.module("otusDomain.project").component("permissionGridComponent",{templateUrl:"app/project/otus-permission/permission-grid/permission-grid-template.html",controller:"permissionGridController as $ctrl",bindings:{userEmail:"="}}).controller("permissionGridController",e),e.$inject=["$mdDialog","ProjectPermissionService"]}(),function(){function e(e,t,n,o){function r(t){return e.getAll(t).then(function(e){try{s(e.data.permissions,t)}catch(n){return o.reject(n)}return c})}function i(t){return e.savePermission(t).then(function(e){return"data"in e?e.data:void o.reject()})}function a(e){return c.findByType(e)}function s(e,n){c=t.create(e,n)}var c,u=this;u.fetchPermissions=r,u.savePermission=i,u.getPermissionByType=a}angular.module("otusDomain.project").service("ProjectPermissionService",e),e.$inject=["PermissionRestService","otusjs.user.permission.PermissionManagerFactory","otusjs.user.permission.SurveyGroupPermissionFactory","$q"]}(),function(){function e(e,t,n,o,r){function i(){a(),u(),n.find("#searchBlock").on("keydown",function(e){e.stopPropagation()})}function a(){try{g.permission=o.getPermissionByType(e.SURVEY_GROUP)}catch(t){throw g.error=!0,"Erro ao recuperar informações de "+e.SURVEY_GROUP}}function s(e,t){return e.sort(),t.sort(),JSON.stringify(t)===JSON.stringify(e)}function c(){var e=angular.copy(g.permission.groups);s(g.permission.groups,g.selectedGroups)?v("Não houve modificações na permissão."):(g.permission.groups=g.selectedGroups,o.savePermission(g.permission).then(function(e){v("Permissão de Grupo salva com sucesso.")})["catch"](function(){g.permission.groups=e,v("Não foi possível salvar permissão.")}))}function u(){t.getListOfSurveyGroups().then(function(e){g.surveysGroups=e,g.selectedGroups=g.permission?angular.copy(g.permission.groups):[],g.groupList=g.surveysGroups.getGroupNames()})["catch"](function(e){Promise.reject(e)})}function l(e){return g.selectedGroups.indexOf(e)>-1}function d(){return 0!==g.selectedGroups.length&&g.selectedGroups.length!==g.groupList.length}function f(){return g.selectedGroups.length===g.groupList.length}function m(){g.selectedGroups.length===g.groupList.length?g.selectedGroups=[]:(0===g.selectedGroups.length||g.selectedGroups.length>0)&&(g.selectedGroups=g.groupList.slice(0))}function p(){g.searchTerm=""}function v(e){r.show(r.simple().textContent(e).position("bottom right").hideDelay(3e3))}var g=this;g.$onInit=i,g.existsGroup=l,g.isIndeterminateGroups=d,g.isCheckedGroup=f,g.toggleAllGroups=m,g.clearSearchTerm=p,g.save=c,g.surveysGroups=[],g.selectedGroups=[],g.groupList=[],g.error=!1}angular.module("otusDomain.project").component("surveyGroupPermission",{templateUrl:"app/project/otus-permission/survey-group/survey-group-permission-template.html",controller:"surveyGroupPermissionCtrl as $ctrl"}).controller("surveyGroupPermissionCtrl",e),e.$inject=["PERMISSION_LIST","otusDomain.project.activity.SurveyGroupConfigurationService","$element","ProjectPermissionService","$mdToast"]}(),function(){function e(e,t,n,o){function r(){l.cloneExtractionIps=angular.copy(l.user.extractionIps),s()}function i(){t.show(u).then(function(){l.cloneExtractionIps=angular.copy(l.user.extractionIps),a(),o.find("#userIp"+l.userIndex).focus()},function(){l.user.extractionIps=angular.copy(l.cloneExtractionIps),o.find("#userIp"+l.userIndex).focus()})}function a(){e.updateExtractionIps(l.user).then(function(e){c("Ip(s) atualizado(s).")})}function s(){u=t.confirm().title(d).textContent(f).ok("Sim").cancel("Cancelar")}function c(e){n.show(n.simple().textContent(e))}var u,l=this,d="Alteração nos IPs de extração",f="Você tem certeza que deseja alterar os IPs de Extração do usuário?";l.$onInit=r,l.onIpChange=i}angular.module("otusDomain.project").component("extractiosIpsField",{templateUrl:"app/project/otus-user/extraction-ips-field/extraction-ips-field-teamplate.html",controller:e,bindings:{user:"=",userIndex:"<"}}),e.$inject=["ExtractionRestService","$mdDialog","$mdToast","$element"]}(),function(){function e(e,t,n,o,r){function i(){j.user=j.selectedUser,g=e.getUserResource(),h=e.getOtusFieldCenterResource(),C=n.create(g),p(),m()}function a(e){o.show(y).then(function(){e.enable?u(e):l(e)},function(){e.enable=!e.enable})}function s(e){o.show(S).then(function(){e.extraction?d(e):f(e)},function(){e.extraction=!e.extraction})}function c(e){C.updateFieldCenter(e).then(function(){v("Centro atualizado.")})}function u(e){C.enable(e).then(function(){v("Usuário habilitado.")})}function l(e){C.disable(e).then(function(){e.extraction&&(e.extraction=!1,f(e)),v("Usuário desabilitado.")})}function d(e){t.enableExtraction(e).then(function(){v("Extração habilitada.")})}function f(e){t.disableExtraction(e).then(function(){v("Extração desabilitada.")})}function m(){h.getAll(function(e){j.fieldCenters=e.data})}function p(){y=o.confirm().title(D).textContent(R).ok("Sim").cancel("Cancelar"),S=o.confirm().title(T).textContent(w).ok("Sim").cancel("Cancelar")}function v(e){r.show(r.simple().textContent(e).hideDelay(3e3)),j.updateUsers()}var g,h,y,S,C,j=this,R="Você tem certeza que deseja alterar o status do usuário?",D="Mudança de Status",w="Você tem certeza que deseja alterar o status de Extração do usuário?",T="Mudança de Status para Extração de Dados";j.fieldCenters=[],j.activeUsers=!0,j.extractionUsers=!1,j.userCenter="",j.$onInit=i,j.enableDisable=a,j.updateFieldCenter=c,j.enableDisableExtraction=s}angular.module("otusDomain.project").component("otusUserManager",{templateUrl:"app/project/otus-user/manager/otus-user-manager-template.html",controller:"otusUserManagerCtrl as $ctrl",bindings:{selectedUser:"<",updateUsers:"&"}}).controller("otusUserManagerCtrl",e),e.$inject=["OtusRestResourceService","ExtractionRestService","UserManagerFactory","$mdDialog","$mdToast"]}(),function(){function e(e){function t(){n.statisticData=e.create(n.users).toJSON(),n.ready=!0}var n=this;n.ready=!1,n.$onInit=t}angular.module("otusDomain.project").component("usersStatisticalData",{templateUrl:"app/project/otus-user/statistical-data/users-statistical-data-template.html",controller:"usersStatisticalDataCtrl as $ctrl",bindings:{users:"="}}).controller("usersStatisticalDataCtrl",e),e.$inject=["usersStatisticalDataFactory"]}(),function(){function e(){function e(e){return new t(e)}var n=this;return n.create=e,n}function t(e){function t(){if(e){i.centers=[],i.total=e.length,i.inactive=e.filter(function(e){return 0==e.enable}).length,i.usersOfExtraction=e.filter(function(e){return 1==e.extraction}).length,o=e.map(function(e){return e.fieldCenter.acronym}),o.sort();for(var t={},n=0;n<o.length;++n)t[o[n]]||(t[o[n]]=0),++t[o[n]];o=Object.keys(t);var r=o.indexOf("undefined"),s=Object.values(t);r>-1&&(o.splice(r,1),s.splice(r,1));for(var c=0;c<o.length;c++)i.centers.push({acronym:o[c],total:s[c]});a={total:i.total,inactive:i.inactive,usersOfExtraction:i.usersOfExtraction,centers:i.centers}}}function n(){return a}var o,r=this,i={},a={};r.toJSON=n,t()}angular.module("otusDomain.project").factory("usersStatisticalDataFactory",e)}(),function(){function e(){function e(e,t,n){function o(){return r=document.createElement("input"),r.setAttribute("type","file"),r.setAttribute("accept",s),r}var r,i=e.reportTemplateUpload,a=i.callback||{},s=i.type||"any";t.on("click",function(){r=o(),r.click(),r.addEventListener("change",function(e){for(var t=e.target.files,n=0;n<t.length;n++){var o=t[n];if(o.type.match("html")){var r=new FileReader;r.addEventListener("load",function(e){var t=e.target;a(t.result)}),r.readAsText(o)}}})})}var t={restrict:"A",link:e,scope:{reportTemplateUpload:"="}};return t}angular.module("otusDomain.dashboard").directive("reportTemplateUpload",e)}(),function(){function e(e){function n(n,o,r){var i=e.getLoggedUser();return new t(n,o,i.email,r)}var o=this;return o.create=n,o}function t(e,t,o,r){function i(){return l}function a(){u.status=!0}function s(){u.status=!1}function c(e){u.status=e}var u=this,l=new n(o,r);u.name=e,u.url=t,u.status=!1,u.getAuthentication=i,u.online=a,u.offline=s,u.changeStatus=c}function n(e,t){var n=this;n.user=e,n.accessToken=t}angular.module("otusDomain.project").factory("ProjectFactory",e),e.$inject=["UserService"]}(),function(){function e(e){function t(t){e.registerObserver(function(e){e?t.show():t.hide()})}var n={retrict:"A",controller:function(e,n,o){e.hasProject()?o.show():o.hide(),t(o)}};return n}angular.module("otusDomain.project").directive("otusWaitingProject",e),e.$inject=["ProjectContext"]}(),function(){function e(e,t){function n(){u=t.getActivityConfigurationResource()}function o(e){if(!u)throw new Error("REST resource is not initialized.");return u.update(e).$promise}function r(e){if(!u)throw new Error("REST resource is not initialized.");return u.create({label:e}).$promise}function i(e){if(!u)throw new Error("REST resource is not initialized.");return u.setDefault({id:e.name}).$promise}function a(){if(!u)throw new Error("REST resource is not initialized.");var t=e.defer();return u.listAll().$promise.then(function(e){e.data&&e.data.length?t.resolve(e.data):t.resolve([])}),t.promise}function s(e){if(!u)throw new Error("REST resource is not initialized.");return u["delete"]({id:e.name}).$promise}var c=this,u=null;c.initialize=n,c.update=o,c.setDefault=i,c.list=a,c.save=r,c.remove=s}angular.module("otusDomain").service("ActivityConfigurationRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e,t){function n(){i=t.getActivityResource()}function o(e){if(!i)throw new Error("REST resource is not initialized.");return i.getById({id:e}).$promise}var r=this,i=null;r.initialize=n,r.getById=o}angular.module("otusDomain").service("ActivityRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e,t){function n(){D=e.getConfigurationResource(),w=e.getProjectConfigurationResource(),T=e.getPermissionConfigurationResource(),b=e.getUserResource(),E=e.getReportResourceFactory()}function o(){var e=t.defer();return b.list(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}function r(){var e=t.defer();return D.getAllSurveys(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}function i(e){var n=t.defer();return D.getByAcronym({acronym:e},function(e){e.data?n.resolve(e.data):n.reject(e.data)}),n.promise}function a(e){var n=t.defer();return D.getSurveyVersions({acronym:e},function(e){e.data?n.resolve(e.data):n.reject(e.data)}),n.promise}function s(e){var n=t.defer();return D.updateSurveyTemplateType({acronym:e.acronym,newSurveyFormType:e.type},function(e){e.data?n.resolve(!0):n.reject(!0)}),n.promise}function c(e){var n=t.defer();return D.deleteSurveyTemplate({acronym:e},function(e){e.data?n.resolve(!0):n.reject(!0)}),n.promise}function u(e){var n=t.defer();return D.publishTemplate(e,function(e){"data"in e?n.resolve(e.data):n.reject(e.MESSAGE)}),n.promise}function l(){var e=t.defer();return D.getVisualIdentity(function(t){e.resolve()}),e.promise}function d(e){var n=t.defer();return D.updateVisualIdentity(e,function(){n.resolve()}),n.promise}function f(){var e=t.defer();if(!w)throw new Error("REST resource is not initialized.");return w.getProjectConfiguration(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}function m(e){if(!w)throw new Error("REST resource is not initialized.");return w.allowNewParticipants({permission:e}).$promise}function p(e){if(!w)throw new Error("REST resource is not initialized.");return w.autoGenerateRecruitmentNumber({permission:e}).$promise}function v(){if(!b)throw new Error("REST resource is not initialized.");return b}function g(e){var n=t.defer();if(!T)throw new Error("REST resource is not initialized.");return T.create(e,function(){n.resolve()}),n.promise}function h(e){var n=t.defer();if(!T)throw new Error("REST resource is not initialized.");return T.update(e,function(){n.resolve()}),n.promise}function y(){var e=t.defer();if(!T)throw new Error("REST resource is not initialized.");return T.getAll(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}function S(e){var n=t.defer();return E.getActivityReportList({acronym:e},function(e){e.data?n.resolve(e.data):n.reject(e.data)}),n.promise}function C(e,n){var o=t.defer();return E.updateActivityReport({id:e,versions:n},function(e){e.data?o.resolve(e):o.reject(e)}),o.promise}function j(e){var n=t.defer();return E.remove({id:e},function(e){e.data?n.resolve(e):n.reject(reponse)}),n.promise}function R(e){var n=t.defer();return E.createActivityReport(e,function(e){"data"in e?n.resolve(e.data):n.reject(e.MESSAGE)}),n.promise}var D,w,T,b,E,U=this;U.$onInit=n,U.getSurveysManagerConfiguration=r,U.getSurveyTemplatesByAcronym=i,U.getSurveyVersions=a,U.publishTemplate=u,U.updateSurveyTemplateType=s,U.deleteSurveyTemplate=c,U.fetchProjectsVisualIdentity=l,U.updateVisualIdentityConfiguration=d,U.getProjectConfiguration=f,U.allowNewParticipants=m,U.autoGenerateRecruitmentNumber=p,U.getUserResource=v,U.setUsersExclusiveDisjunction=g,U.updateUsersExclusiveDisjunction=h,U.getCollectionOfPermissions=y,U.fetchUsers=o,U.getActivityReports=S,U.updateActivityReport=C,U.deleteActivityReport=j,U.publishActivityReport=R,n()}angular.module("otusDomain.rest").service("otusDomain.rest.configuration.ProjectConfigurationService",e),e.$inject=["OtusRestResourceService","$q"]}(),function(){function e(e){function t(){s=e.getDatasourceResourceFactory()}function n(e){if(!s)throw new Error("REST resource is not initialized.");return s.create(e)}function o(e){if(!s)throw new Error("REST resource is not initialized.");return s.update(e)}function r(){if(!s)throw new Error("REST resource is not initialized.");return s.list()}function i(e){if(!s)throw new Error("REST resource is not initialized.");return s.getById(e)}var a=this,s=null;a.initialize=t,a.create=n,a.update=o,a.list=r,a.getById=i}angular.module("otusDomain.rest").service("DatasourceRestService",e),e.$inject=["OtusRestResourceService"]}(),function(){function e(e,t){function n(){a=t.getUserPermissionResource()}function o(e){if(!a)throw new Error("REST resource is not initialized.");return a.getAll({email:e}).$promise}function r(e){if(!a)throw new Error("REST resource is not initialized.");return a.savePermission(e).$promise}var i=this,a=null;i.initialize=n,i.getAll=o,i.savePermission=r}angular.module("otusDomain.rest").service("PermissionRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e,t){function n(){u=t.getReportResourceFactory()}function o(e){if(!u)throw new Error("REST resource is not initialized.");return u.create(e).$promise}function r(){if(!u)throw new Error("REST resource is not initialized.");return u.listAll().$promise}function i(e){if(!u)throw new Error("REST resource is not initialized.");return u.update(e).$promise}function a(e){if(!u)throw new Error("REST resource is not initialized.");return u.getById({id:e}).$promise}function s(e){if(!u)throw new Error("REST resource is not initialized.");return u.remove({id:e}).$promise}var c=this,u=null;c.initialize=n,c.update=i,c.getById=a,c.list=r,c.create=o,c.remove=s}angular.module("otusDomain").service("ReportRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e,t){function n(){u=t.getSurveyGroupResource()}function o(){var t=e.defer();if(!u)throw new Error("REST resource is not initialized.");return u.getListOfSurveyGroups(function(e){"data"in e?t.resolve(e.data):t.reject(!0)}),t.promise}function r(e){if(!u)throw new Error("REST resource is not initialized.");return u.addNewSurveyGroup(e).$promise}function i(e){if(!u)throw new Error("REST resource is not initialized.");return u.updateSurveyGroupName(e).$promise}function a(t){var n=e.defer();if(!u)throw new Error("REST resource is not initialized.");return u.updateSurveyGroupAcronyms(t,function(e){"data"in e?n.resolve(e.data):n.reject(e)}),n.promise}function s(e){if(!u)throw new Error("REST resource is not initialized.");return u.deleteSurveyGroup(e).$promise}var c=this,u=null;c.initialize=n,c.getListOfSurveyGroups=o,c.addNewSurveyGroup=r,c.updateSurveyGroupName=i,c.updateSurveyGroupAcronyms=a,c.deleteSurveyGroup=s}angular.module("otusDomain.rest").service("SurveyGroupRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e,t,n){function o(){u=e.getUserResource(),c()}function r(e){e.enable?a(e):s(e)}function i(e){var n=t.confirm().title(f).textContent(d).ok("Sim").cancel("Cancelar");t.show(n).then(function(){r(e)},function(){e.enable=!e.enable})}function a(e){u.enable(e,function(){n.show(n.simple().textContent("Usuário habilitado."))})}function s(e){u.disable(e,function(){n.show(n.simple().textContent("Usuário desabilitado."))})}function c(){u.list(function(e){l.users=e.data})}var u,l=this,d="Você tem certeza que deseja alterar o status do usuário ?",f="Mudança de Status";l.users=[],l.confirmDialog=i,o()}angular.module("otusDomain.user.management").controller("UserActivationController",e),e.$inject=["RestResourceService","$mdDialog","$mdToast"]}(),function(){function e(e,t,n,o){function r(e){var t=o.getUserResource();t.create(e,function(e){e.data&&a()})}function i(){n.goToLogin()}function a(){var e=t.alert().title("Informação").content(s).ok("ok");t.show(e)["finally"](function(){n.goToLogin()})}var s="Sua liberação está pendente de aprovação.",c=this;c.register=r,c.back=i}angular.module("otusDomain.user.management").controller("UserRegisterController",e),e.$inject=["$http","$mdDialog","DashboardStateService","RestResourceService"]}(),function(){angular.module("otusDomain.user.management").directive("unique",["$http","$q","RestResourceService",function(e,t,n){return{restrict:"A",require:"ngModel",link:function(e,o,r,i){i.$asyncValidators.emailInUse=function(e){var o=t.defer(),r=n.getUserResource();return r.exist({email:e},function(e){e.data?o.reject():o.resolve()}),o.promise}}}}])}(),function(){function e(){function e(){i.permission=null,i.survey=null}function t(){return i.survey}function n(e){i.survey=e}function o(){return i.permission}function r(e){i.permission=e}var i=this;i.survey,i.permission,i.$onInit=e,i.getSurveyOfContext=t,i.setSurveyInContext=n,i.getPermissionOfContext=o,i.setPermissionInContext=r}angular.module("otusDomain.dashboard").service("ActivityConfigurationManagerService",e),e.$inject=[]}(),function(){function e(e){function t(e){return e.forEach(function(e){n(e),o(e),r(e)}),e}function n(t){if(t.extractionValues)if(i(t.objectType))t.extractionValues=t.extractionValues.map(function(n){switch(t.objectType){case"SingleSelectionQuestion":return n=e.t("extractionValues.SingleSelectionQuestion",{extractionValue:n});case"CheckboxQuestion":return n.label=e.t("booleanValue."+n.label),n=e.t("extractionValues.CheckboxQuestion",{extractionValue:n})}});else switch(t.objectType){case"AutocompleteQuestion":return t.extractionValues=e.t("extractionValues.AutocompleteQuestion");case"FileUploadQuestion":return t.extractionValues=e.t("extractionValues.FileUploadQuestion");default:return t.extractionValues=e.t("extractionValues.Default");
}}function o(t){t.validationTypes&&(t.validationTypes=t.validationTypes.map(function(t){return"mandatory"!==t.name&&"accept"!==t.name&&"alphanumeric"!==t.name&&"futureDate"!==t.name&&"pastDate"!==t.name||(t.value=e.t("booleanValue."+t.value)),t=e.t("validationTypes."+t.name,{validation:t})}))}function r(t){t.objectType=e.t("questionDataType."+t.objectType)}function i(e){return"SingleSelectionQuestion"===e||"CheckboxQuestion"===e}var a=this;a.translate=t}angular.module("otusDomain.dashboard").service("otusDomain.dashboard.business.SurveyTemplateTranslateService",e),e.$inject=["$i18next"]}(),function(){function e(e,t){function n(){r()}function o(){a.newCategoryLabel?t.save(a.newCategoryLabel).then(function(e){a.newCategoryLabel="",a.categories.push(e.data)}):i()}function r(){t.list().then(function(e){a.categories=e})}function i(){e.show(e.simple().textContent("A label não pode ser vazia").hideDelay(2e3))}var a=this;a.newCategoryLabel="",a.$onInit=n,a.newCategory=o,a.listCategories=r}angular.module("otusDomain.dashboard").component("activityCategoryConfiguration",{controller:e,templateUrl:"app/project/configuration/activity/category/category-configuration-template.html"}),e.$inject=["$mdToast","ActivityConfigurationRestService"]}(),function(){function e(e,t,n){function o(){r()}function r(){n.getListOfSurveyGroups().then(function(e){f.groups=e.getGroupList(),0===f.groups.length?f.error="Atualmente não existem grupos cadastrados, para criar um grupo você deve definir um nome e clicar em adicionar.":f.error=void 0})["catch"](function(e){f.groups=[],f.error="Erro de comunicação com servidor, tente novamente mais tarder."})}function i(){f.newGroup?n.addNewSurveyGroup(f.newGroup).then(function(t){e.show(e.simple().textContent("O novo grupo foi adicionado na lista.").hideDelay(2e3)),r()})["catch"](function(t){d===t.message?e.show(e.simple().textContent("O nome escolhido já está em uso!").hideDelay(2e3)):e.show(e.simple().textContent("Ocorreu um erro, tente novamente mais tarde.").hideDelay(2e3))}):e.show(e.simple().textContent("Você precisar definir um nome para o grupo!").hideDelay(2e3)),f.newGroup=""}function a(e){l=e.getName(),e.editMode=!e.editMode}function s(e,t){return!t||e!=l}function c(t){n.updateSurveyGroupName(l,t.getName()).then(function(n){"Data Validation Fail: SurveyGroupName already in use"===n.MESSAGE?(e.show(e.simple().textContent("Ocorreu um erro na tentativa de atualização. Por favor, verifique os dados informados.").hideDelay(2e3)),t.editMode=!1,r()):(e.show(e.simple().textContent("O nome do grupo foi atualizado.").hideDelay(2e3)),r())})["catch"](function(t){e.show(e.simple().textContent("Ocorreu um erro, tente novamente mais tarde.").hideDelay(2e3))})}function u(o){f.message="Você tem certeza que deseja excluir esse grupo?",o.getSurveys().length>0&&(f.message="Existem atividades relacionadas ao grupo, você tem certeza que deseja excluir esse grupo?"),t.show(t.confirm().title("Exclusão do grupo").textContent(f.message).ariaLabel("exclusão do grupo").ok("Sim").cancel("Não")).then(function(){n.deleteSurveyGroup(o.getName()).then(function(t){e.show(e.simple().textContent("O grupo foi excluído.").hideDelay(2e3)),r()})["catch"](function(t){e.show(e.simple().textContent("Ocorreu um erro, tente novamente mais tarde.").hideDelay(2e3))})})}var l,d="Group already exists",f=this;f.groups,f.newGroup="",f.error,f.message,f.$onInit=o,f.addNewSurveyGroup=i,f.edit=a,f.updateSurveyGroupName=c,f.deleteSurveyGroup=u,f.validUpdateName=s}angular.module("otusDomain.dashboard").component("surveyGroupConfiguration",{controller:"surveyGroupConfigurationController as $ctrl",templateUrl:"app/project/configuration/activity/group/survey-group-configuration-template.html"}).controller("surveyGroupConfigurationController",e),e.$inject=["$mdToast","$mdDialog","otusDomain.project.activity.SurveyGroupConfigurationService"]}(),function(){function e(e,t,n){function o(){return t.getListOfSurveyGroups().then(function(e){return c=n.create(e)})["catch"](function(t){return e.reject(t)})}function r(n){try{var o=c.createGroup(n,[]);return t.addNewSurveyGroup(o).then(function(e){return e})["catch"](function(t){return e.reject(t)})}catch(r){return e.reject(r)}}function i(n,o){var r={surveyGroupName:n,newSurveyGroupName:o};return n===o?Promise.resolve({}):t.updateSurveyGroupName(r).then(function(e){return e})["catch"](function(t){return e.reject(t)})}function a(n){var o={surveyGroupName:n,newSurveyGroupName:""};return t.deleteSurveyGroup(o).then(function(e){return e})["catch"](function(t){return e.reject(t)})}function s(n){return t.updateSurveyGroupAcronyms(n).then(function(e){return e})["catch"](function(t){return e.reject(t)})}var c,u=this;u.getListOfSurveyGroups=o,u.addNewSurveyGroup=r,u.updateSurveyGroupName=i,u.updateSurveyGroupAcronyms=s,u.deleteSurveyGroup=a}angular.module("otusDomain.project").service("otusDomain.project.activity.SurveyGroupConfigurationService",e),e.$inject=["$q","SurveyGroupRestService","otusjs.survey.GroupManagerFactory"]}(),function(){function e(e,t,n,o,r,i,a,s,c,u,l){function d(){V.error=!1,V.users=[],V.AllUsers=[],V.versions=[],V.usersList=[],V.surveyTemplatesList=[],V.currentSurvey=n.getSurveyOfContext(),V.permission=n.getPermissionOfContext(),V.activityReportList=[],V.outOfReportVersionList=[],V.persistentActivityReport=!1,C(),j(),R(),V.loadActivityReportList(V.currentSurvey.surveyTemplate.identity.acronym)}function f(e){V.permission._id?i.updateUsersExclusiveDisjunction(V.permission).then(function(t){T(e,M)})["catch"](function(e){T("Não foi possível atualizar configurações",M)}):i.setUsersExclusiveDisjunction(V.permission).then(function(t){i.getCollectionOfPermissions().then(function(e){V.permissionList=angular.copy(e),w()}),T(e,M)})["catch"](function(e){T("Não foi possível atualizar configurações",M)})}function m(e){var t=V.currentSurvey.surveyTemplate.identity.acronym,n=""+t,o=document.createElement("a");if(e){var r=V.surveyTemplatesList.find(function(t){if(t.version===e)return t});n=n.concat(e),o.setAttribute("href",b(JSON.stringify(r.surveyTemplate)))}else o.setAttribute("href",b(JSON.stringify(V.currentSurvey.surveyTemplate))),n=n.concat(V.currentSurvey.version);o.setAttribute("download",n+".json"),o.setAttribute("target","_blank"),o.click()}function p(e){var t="[acronym] AS [SIGLA], [extractionID] AS [ID_DA_QUESTAO], [objectType] AS [TIPO_DA_QUESTAO], [extractionValues] AS [VALORES_DE_EXTRACAO], [label] AS [LABEL], [metadata] AS [METADADOS], [validationTypes] AS [VALIDACOES]",n=V.currentSurvey.surveyTemplate.identity.acronym,o="dicionario-de-variaveis_"+n;if(e){var i=V.surveyTemplatesList.find(function(t){if(t.version===e)return t}),s=a.translate(r.createDictionary(i.surveyTemplate));o=o.concat(e+"_"),o=o.concat((new Date).toLocaleDateString()),alasql("SELECT "+t+' INTO CSV("'+o+'.csv") FROM ? ',[s])}else{var s=a.translate(r.createDictionary(V.currentSurvey.surveyTemplate));o=o.concat(V.currentSurvey.version+"_"),o=o.concat((new Date).toLocaleDateString()),alasql("SELECT "+t+' INTO CSV("'+o+'.csv") FROM ? ',[s])}}function v(e){return angular.isObject(e)?e:{name:e,type:"new"}}function g(e){V.permission.addUser(e.email),f(F)}function h(e){V.permission.removeUser(e.email),f(k)}function y(e){return e?V.AllUsers.filter(S(e)):[]}function S(e){var t=e.toLowerCase();return function(e){return e.name.toLowerCase().indexOf(t)!==-1}}function C(){i.fetchUsers().then(function(e){D(e),V.permission.exclusiveDisjunction.forEach(function(e){V.AllUsers.forEach(function(t){t.email===e&&V.users.push(t)})})})}function j(){var e=V.currentSurvey.surveyTemplate.identity.acronym;i.getSurveyVersions(e).then(function(e){V.versions=e})["catch"](function(){V.error=!0,V.message=G})}function R(){t.start();var e=V.currentSurvey.surveyTemplate.identity.acronym;i.getSurveyTemplatesByAcronym(e).then(function(e){V.surveyTemplatesList=e,t.finish()})["catch"](function(){V.error=!0,V.message=G,t.finish()})}function D(e){e.forEach(function(e){V.AllUsers.push({name:e.name,email:e.email})})}function w(){V.permissionList.forEach(function(e){e.acronym===V.permission.acronym&&e.version==V.permission.version&&(V.permission=o.fromJsonObject(e))})}function T(t,n){e.show(e.simple().textContent(t).position("right bottom").hideDelay(n))}function b(e){return"data:text/json;charset=utf-8,"+encodeURIComponent(e)}function E(e){x(),i.getActivityReports(e).then(function(e){return V.activityReportList=u.getActivityReports(e)}).then(function(){return j()}).then(function(){return U(V.versions)}).then(function(){return V.persistentActivityReport=!0})["catch"](function(){return V.persistentActivityReport=!1})}function U(e){if(V.activityReportList.length){var t=angular.copy(e);V.activityReportList.forEach(function(e){e.versions.forEach(function(e){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}),V.activityVersionsAvailable=t}}function $(e){var t=e.versions;if(t.length){var n=s.confirm().title(N.versionChangeConfirmationTitle).htmlContent(' \n                         <md-content>\n                            <p class="md-subhead">Atual: ['+e.getCurrentVersions()+']</p>\n                            <p class="md-subhead">Modificado: ['+t+"]</p> \n                         </md-content>\n                         ").ok(N.reportConfirmationButtonYes).cancel(N.reportConfirmationButtonNo);s.show(n).then(function(){i.updateActivityReport(e.id,t).then(function(){return A("Versões Atualizadas")}).then(function(){return E(V.currentSurvey.surveyTemplate.identity.acronym)})})}else A("Não é permitido relatório sem versão")}function A(t){e.show(e.simple().textContent(t).hideDelay(4e3))}function x(){V.activityReportList=[],V.activityVersionsAvailable=[]}function O(e){$(e),c.destroy()}function P(e){e&&e.cancelUpdateVersion(),c.cancel()}function L(e){var t=s.confirm().title(N.versionDeleteConfirmationTitle).htmlContent('<md-content>                         \n                         <p class="md-subhead">Titulo: '+e.label+'</p>\n                         <p class="md-subhead">Versão: ['+e.versions+"]</p> \n                      </md-content>").ariaLabel("delete confirmation").ok(N.reportConfirmationButtonYes).cancel(N.reportConfirmationButtonNo);s.show(t).then(function(){i.deleteActivityReport(e.id).then(function(){return E(V.currentSurvey.surveyTemplate.identity.acronym)})})}function I(){V.activityReportList.length||(V.activityVersionsAvailable=V.versions),l.loadActivityReport(V)}var N={versionChangeConfirmationTitle:"Deseja confirmar as seguintes alterações no relatório ?",reportConfirmationButtonYes:"SIM",reportConfirmationButtonNo:"NÃO",versionDeleteConfirmationTitle:"Você tem certeza que deseja excluir este RELATÓRIO?"},G="Não foi possível apresentar os dados. Por favor, tente novamente em alguns minutos.",F="Usuário adicionado com sucesso.",k="Usuário removido com sucesso.",M=2e3,V=this;V.error,V.users,V.message,V.AllUsers,V.versions,V.usersList,V.surveyTemplatesList,V.persistentActivityReport,V.$onInit=d,V.querySearch=y,V.saveSettings=f,V.downloadTemplate=m,V.downloadVariables=p,V.transformChip=v,V.onAdd=g,V.onRemove=h,V.deleteReport=L,V.updateSelectVersion=O,V.cancelSelectVersion=P,V.loadActivityReport=I,V.loadActivityReportList=E}angular.module("otusDomain.dashboard").component("activitySettings",{controller:"activitySettingsCtrl as $ctrl",templateUrl:"app/project/configuration/activity/settings/activity-settings-template.html"}).controller("activitySettingsCtrl",e),e.$inject=["$mdToast","otusDomain.LoadingScreenService","ActivityConfigurationManagerService","otusjs.model.activity.ActivityPermissionFactory","SurveyFactory","otusDomain.rest.configuration.ProjectConfigurationService","otusDomain.dashboard.business.SurveyTemplateTranslateService","$mdDialog","$mdSelect","ActivitySettingsService","ActivityReportDialogService"]}(),function(){function e(e){function t(t){return o=[],t.length&&t.forEach(function(t){o.push(e.create(t))}),o}var n=this,o=[];n.getActivityReports=t}angular.module("otusDomain.dashboard").service("ActivitySettingsService",e),e.$inject=["ActivityReportFactory"]}(),function(){function e(e,t,n,o,r,i,a,s){function c(){b.surveyGroupsEditMode=!1,b.permissionList=[],R(),j(),C(),b.permission=i.fromJsonObject({acronym:b.surveyForm.surveyTemplate.identity.acronym,version:b.surveyForm.version})}function u(){S(),s.setSurveyInContext(b.surveyForm),s.setPermissionInContext(b.permission),a.goToActivitySettings()}function l(){b.blocEdit?r.show(r.simple().textContent("Você já esta em modo de edição em outra atividade").hideDelay(2e3)):(b.mirrorEditModeStatus({status:!0}),b.surveyGroupsEditMode=!0)}function d(){t.getListOfSurveyGroups().then(function(e){var n=e.getSurveyGroups(b.surveyForm.surveyTemplate.identity.acronym),o=f(n);o.forEach(function(n){var o=e.getGroup(n);o&&(o.removeSurvey(b.surveyForm.surveyTemplate.identity.acronym),t.updateSurveyGroupAcronyms(o.toJSON()))}),m(e,p(n)).then(function(e){e.length>0&&r.show(r.simple().textContent("Grupo(s) ("+e+") não encontado(s)").hideDelay(5e3)),j()}),b.mirrorEditModeStatus({status:!1}),b.surveyGroupsEditMode=!1})}function f(e){return e.filter(function(e){var t=b.surveyForm.groups.filter(function(t){if(t.getName()===e)return!0});return t.length<=0})}function m(n,o){var r=e.defer(),i=[];return o.forEach(function(e,a){var s=n.getGroup(e.getName());s?(s.addSurvey(b.surveyForm.surveyTemplate.identity.acronym),t.updateSurveyGroupAcronyms(s.toJSON()).then()["catch"](function(){i.push(e.getName()),a===o.length-1&&r.resolve(i)})):(i.push(e.getName()),a===o.length-1&&r.resolve(i))}),r.promise}function p(e){return b.surveyForm.groups.filter(function(t){var n=e.filter(function(e){if(t.getName()===e)return!0});return n.length<=0})}function v(){o.show(D).then(function(){var e=b.surveyTemplates.indexOf(b.surveyForm);n.deleteSurveyTemplate(b.surveyForm.surveyTemplate.identity.acronym).then(function(){b.surveyTemplates.splice(e,1),r.show(r.simple().textContent("Excluído").hideDelay(2e3))})["catch"](function(){r.show(r.simple().textContent("Erro ao excluir").hideDelay(2e3))})},function(){})}function g(e){return e?b.groupsManager.getGroupList().filter(h(e)):[]}function h(e){var t=e.toLowerCase();return function(e){return e.getName().toLowerCase().indexOf(t)!==-1}}function y(e){$log.log("The model has changed to "+JSON.stringify(e)+".")}function S(){b.permissionList.forEach(function(e){e.acronym===b.surveyForm.surveyTemplate.identity.acronym&&e.version==b.surveyForm.version&&(b.permission=i.fromJsonObject(e))})}function C(){n.getCollectionOfPermissions().then(function(e){b.permissionList=e})["catch"](function(){r.show(r.simple().textContent(w).hideDelay(T))})}function j(){t.getListOfSurveyGroups().then(function(e){var t=e.getSurveyGroups(b.surveyForm.surveyTemplate.identity.acronym);b.surveyForm.groups=[],t.forEach(function(t){b.surveyForm.groups.push(e.getGroup(t))}),b.groupsManager=e})["catch"](function(){b.groups=[]})}function R(){D=o.confirm().title("Exclusão de Formulário").textContent("Você tem certeza que deseja excluir esse Formulário?").ariaLabel("exclusão de formulário").ok("Sim").cancel("Não")}var D,w="Ocorreu algum problema, tente novamente mais tarde",T=5e3,b=this;b.showSettings,b.usersList=[],b.groups=[],b.$onInit=c,b.showActivitySettings=u,b.deleteSurveyTemplate=v,b.querySearch=g,b.onModelChange=y,b.surveyGroupsEdit=l,b.updateSurveyGroups=d}angular.module("otusDomain.dashboard").component("surveyTemplateConfiguration",{controller:"surveyTemplateConfigurationCtrl as $ctrl",templateUrl:"app/project/configuration/activity/survey-template/survey-template-configuration-template.html",bindings:{surveyForm:"<",surveyTemplates:"=",mirrorEditModeStatus:"&",blocEdit:"<"}}).controller("surveyTemplateConfigurationCtrl",e),e.$inject=["$q","otusDomain.project.activity.SurveyGroupConfigurationService","otusDomain.rest.configuration.ProjectConfigurationService","$mdDialog","$mdToast","otusjs.model.activity.ActivityPermissionFactory","DashboardStateService","ActivityConfigurationManagerService"]}(),function(){function e(e,t,n){function o(){i()}function r(){var t=e.defer();return t.resolve(!0),t.promise}function i(){r().then(function(e){e.files?m.data=e:m.data={files:{logoURL:p,bannerURL:p},date:""}})["finally"](function(){m.changed=!1})}function a(e){m.progressBanner=!0,c(e).then(function(e){m.data.files.bannerURL=e,m.changed=!0,m.progressBanner=!1})}function s(e){m.progressLogo=!0,c(e).then(function(e){m.data.files.logoURL=e,m.changed=!0,m.progressLogo=!1})}function c(t){var n=e.defer(),o=new FileReader;return o.onload=function(){n.resolve(o.result)},o.readAsDataURL(t[0]),n.promise}function u(){m.changed=!1;var e={files:{logo:m.data.files.logoURL,banner:m.data.files.bannerURL},sendingDate:new Date};t.updateVisualIdentityConfiguration(e,l,d)}function l(){m.data.sendingDate=f(new Date),n.show(n.simple().textContent("Salvo com sucesso"))}function d(){n.show(n.simple().textContent("Falha ao atualizar imagem")),i()}function f(e){return e.toLocaleDateString()+" - "+e.toLocaleTimeString()}var m=this;o(),m.progressBanner=!1,m.progressLogo=!1,m.uploadBanner={callback:a,type:"image"},m.uploadLogo={callback:s,type:"image"},m.save=u;var p="app/assets/img/image_not_found.jpg"}angular.module("otusDomain.project.configuration").component("otusVisualIdentity",{templateUrl:"app/project/configuration/config-components/project-visual-identity-component/project-visual-identity-template.html",controller:e}),e.$inject=["$q","otusDomain.rest.configuration.ProjectConfigurationService","$mdToast"]}(),function(){function e(e,t,n,o,r,i,a){function s(){u(h.projects),d()}function c(){t.cancel()}function u(e){e.forEach(function(e){o.isOnline(e)})}function l(e){e.status?o.authenticate(e).then(function(t){f(t.data,e),c()},function(){d(),p()}):m()}function d(){if(i.hasProject()){var e=i.getCurrentProject();a.setUrl(e.projectRestUrl),a.setSecurityToken(e.sessionToken)}}function f(e,t){t.sessionToken=e,a.setSecurityToken(t.sessionToken),i.setProject(t)}function m(){r.show(r.simple().textContent(v))}function p(){r.show(r.simple().textContent(g))}var v="Projeto Offline. Verifique o estado do projeto.",g="Erro ao realizar autenticação no projeto",h=this;h.projects=n,h.close=c,h.select=l,s()}angular.module("otusDomain.project").controller("ProjectChooseController",e),e.$inject=["$scope","$mdDialog","projects","ProjectSecurityService","$mdToast","ProjectContext","OtusRestResourceService"]}(),function(){function e(e,t){function n(n,o,r){n.project=t.getCurrentProject(),n.chooseProject=function(){e.choose()},n.hasProject=function(){return t.hasProject()},t.registerObserver(function(e){n.project=e})}var o={templateUrl:"app/project/selection/ui/toolbar/otus-project-selection-toolbar.html",restrict:"E",link:n};return o}angular.module("otusDomain.project").directive("otusProjectSelection",e),e.$inject=["ProjectSelectionService","ProjectContext"]}(),function(){function e(e,t,n){function o(){u()}function r(){f.onUpdate=!0}function i(){f.categoryData.label?n.update(f.categoryData).then(function(){f.onUpdate=!1,d.textContent("A categoria "+f.categoryData.label+" sera removida")}):l()}function a(){f.categoryData.isDefault?(f.categoryData.isDefault=1,c()):n.setDefault(f.categoryData).then(function(){f.reloadCategories()})}function s(){f.categoryData.isDefault?c():t.show(d).then(function(){n.remove(f.categoryData).then(function(){f.reloadCategories()})})}function c(){e.show(e.simple().textContent("Uma nova categoria padrão deve ser definida").hideDelay(2e3))}function u(){d=t.confirm().title("Confirmar remoção:").textContent("A categoria "+f.categoryData.label+" sera removida").ariaLabel("Confirmação de remoção").ok("Ok").cancel("Voltar")}function l(){e.show(e.simple().textContent("A label não pode ser vazia").hideDelay(2e3))}var d,f=this;f.onUpdate=!1,f.$onInit=o,f.categoryUpdate=r,f.saveCategory=i,f.removeCategory=s,f.saveDefault=a}angular.module("otusDomain.dashboard").component("categoryEdit",{controller:e,templateUrl:"app/project/configuration/activity/category/category-edit/category-edit-template.html",bindings:{categoryData:"<",reloadCategories:"&"}}),e.$inject=["$mdToast","$mdDialog","ActivityConfigurationRestService"]}(),function(){function e(e,t,n,o,r){function i(t){s.ComponentCtrl=t,e.show({controller:a,controllerAs:"$ctrl",templateUrl:"app/project/configuration/activity/settings/activity-report/activity-report-load-dialog-template.html",parent:angular.element(document.body),clickOutsideToClose:!0})}function a(e){function i(){e.cancel()}function a(){r.destroy()}function u(e){e.forEach(function(t){"json"===e[0].name.split(".")[1]&&l(t).then(function(e){s.uploadedObject=JSON.parse(e),s.uploadedObject.versions=m.availableVersions,s.uploadedObject.sendingDate=(new Date).toISOString(),s.uploadedFile=JSON.stringify(s.uploadedObject)}).then(function(){return m.uploadButtonState=!0})})}function l(e){var n=t.defer(),o=new FileReader;return o.onload=function(){n.resolve(o.result)},o.readAsText(e),n.promise}function d(){var e=s.ComponentCtrl.currentSurvey.surveyTemplate.identity.acronym;if(s.uploadedObject.acronym!==e)throw f(c.acronymInvalid),m.cancel(),new Error(c.acronymInvalidError);o.publishActivityReport(s.uploadedFile).then(function(){return f(c.addSuccess)}).then(function(){return s.ComponentCtrl.loadActivityReportList(e)})["catch"](function(){return f(c.addFail)}).then(function(){return m.cancel()})}function f(e){n.show(n.simple().textContent(e).hideDelay(4e3))}var m=this;m.activityVersionsAvailable=s.ComponentCtrl.activityVersionsAvailable,m.uploadButtonState=!1,m.uploadedObject={},m.uploadedFile={},m.uploadConfig={callback:u,type:"json"},m.publishReport=d,m.cancel=i,m.skipSelect=a}var s=this,c={addSuccess:"Relatório Adicionado",addFail:"Ocorreu um erro interno: Relatório não foi adicionado",acronymInvalid:"Relatório pertence a outra atividade",acronymInvalidError:"report with different acronym"};s.loadActivityReport=i}angular.module("otusDomain.dashboard").service("ActivityReportDialogService",e),e.$inject=["$mdDialog","$q","$mdToast","otusDomain.rest.configuration.ProjectConfigurationService","$mdSelect"]}(),function(){function e(){function e(e){return new t(e)}var n=this;return n.create=e,n}function t(e){function t(){r.versions=i}function n(){i=r.versions}function o(){return i}var r=this,i=e.versions;return r.id=e._id,r.objectType="ActivityReport",r.template=e.template,r.label=e.label,r.sendingDate=e.sendingDate,r.acronym=e.acronym,r.versions=e.versions,r.datasources=e.datasources,r.cancelUpdateVersion=t,r.updateCurrentVersions=n,r.getCurrentVersions=o,r}angular.module("otusDomain.dashboard").factory("ActivityReportFactory",e)}();