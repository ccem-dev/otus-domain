"use strict";!function(){angular.module("otusDomain",["dependencies","otusjs","otusDomain.dashboard","otusDomain.rest","otusDomain.authenticator","otusDomain.installer","otusDomain.repository","otusDomain.project","otusDomain.project.fieldCenter","otusDomain.project.configuration","otusDomain.project.datasource","otus.domain.client","otus.client","otusDomain.user","utils","ngMaterial"])}(),function(){angular.module("otusDomain.authenticator",[])}(),function(){angular.module("otusDomain.dashboard",[])}(),function(){angular.module("dependencies",["ngMaterial","ngMessages","ngAnimate","ui.mask","ui.router","colorpicker.module"])}(),function(){window.__env=window.__env||{},window.__env.apiUrl="https://api-domain.localhost"}(),function(){function e(e,t,o){var n=t.__env;e.setUrl(n.apiUrl),o.reloadLoggedUser()}angular.module("otusDomain").run(["RestResourceService","$window","UserService",e])}(),function(){function e(e){e.formatDate=function(e){return moment(e).format("DD/MM/YYYY")},e.parseDate=function(e){var t=moment(e,"DD/MM/YYYY",!0);return t.isValid()?t.toDate():new Date(NaN)}}angular.module("otusDomain").config(["$mdDateLocaleProvider",e])}(),function(){function e(e){e.errorOnUnhandledRejections(!1)}angular.module("otusDomain").config(e),e.$inject=["$qProvider"]}(),function(){function e(e,t,o,n,r,i,a){function c(){var e=o.defer();return a.isLogged()?e.resolve():e.reject({redirectTo:i.LOGIN}),e.promise}function u(){var e=o.defer();return a.isLogged()?e.reject({redirectTo:i.HOME}):e.resolve(),e.promise}function s(){var e=o.defer();return n.hasProject()?e.resolve():e.reject({redirectTo:i.HOME}),e.promise}function l(){var e=o.defer();return a.getInstallerResource().ready(function(t){t.data?e.resolve():e.reject({redirectTo:i.INSTALLER})}),e.promise}function d(){var e=o.defer();return a.getInstallerResource().ready(function(t){t.data?e.reject({redirectTo:i.LOGIN}):e.resolve()}),e.promise}var f=this;f.loggedUser=c,f.alreadyLogged=u,f.selectedProject=s,f.initialConfiguration=l,f.onlyOneConfiguration=d,t.$on("$stateChangeError",function(t,o,n,r,i,a){t.preventDefault(),a.redirectTo?e.go(a.redirectTo):e.go("error",{status:a.status})})}angular.module("otusDomain").service("RouteRulesResolver",e),e.$inject=["$state","$rootScope","$q","ProjectContext","DashboardStateService","APP_STATE","RestResourceService"]}(),function(){function e(e,t){var o="app/dashboard/menu/dashboard-menu.html",n="app/dashboard/template/main-dashboard-template.html";e.state("installer",{url:"/installer",resolve:{onlyOneConfiguration:function(e){return e.onlyOneConfiguration()}},views:{"system-wrap":{templateUrl:"app/installer/initial/initial-config.html",controller:"InitialConfigController as initialConfigController"},"repository-config@installer":{templateUrl:"app/survey-repository/repository.html",controller:"InitialConfigController as initialConfigController"}}}).state("login",{url:"/login",resolve:{loggedUser:function(e){return e.alreadyLogged()},initialConfiguration:function(e){return e.initialConfiguration()}},views:{"system-wrap":{templateUrl:"app/authenticator/login/login.html",controller:"LoginController",controllerAs:"loginController"}}}).state("user-register",{url:"/user/register",resolve:{initialConfiguration:function(e){return e.initialConfiguration()}},views:{"system-wrap":{templateUrl:"app/user/management/registry/user-register.html",controller:"UserRegisterController",controllerAs:"userRegisterController"}}}).state("user-activation",{url:"/user/activation",resolve:{loggedUser:function(e){return e.loggedUser()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@user-activation":{templateUrl:o},"system-content@user-activation":{templateUrl:"app/user/management/activation/user-activation.html",controller:"UserActivationController",controllerAs:"$ctrl"}}}).state("user-otus-management",{url:"/project/user",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@user-otus-management":{templateUrl:o},"system-content@user-otus-management":{template:'<otus-user flex="80"></otus-user>'}}}).state("field-center",{url:"/project/centers",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},loadCenters:function(e){e.loadCenters()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@field-center":{templateUrl:o},"system-content@field-center":{templateUrl:"app/project/fieldCenter/field-center-template.html",controller:"FieldCenterController",controllerAs:"fieldCenterController"}}}).state({name:"activity_configuration",url:"/project/activity_configuration",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e){e.initialize()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@activity_configuration":{templateUrl:o},"system-content@activity_configuration":{template:'<activity-configuration flex="80"></activity-configuration>'}}}).state({name:"activity_settings",url:"/project/activity_configuration/settings",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e){e.initialize()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@activity_settings":{templateUrl:o},"system-content@activity_settings":{template:'<activity-settings flex="80"></activity-settings>'}}}).state({name:"report_manager",url:"/project/report_manager",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e){e.initialize()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@report_manager":{templateUrl:o},"system-content@report_manager":{template:'<report-manager flex="80"></report-manager>'}}}).state({name:"datasource_manager",url:"/project/datasource_manager",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e){e.initialize()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@datasource_manager":{templateUrl:o},"system-content@datasource_manager":{template:'<datasource-manager flex="80"></datasource-manager>'}}}).state("home",{url:"/home",resolve:{loggedUser:function(e){return e.loggedUser()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@home":{templateUrl:o},"system-content@home":{templateUrl:"app/dashboard/template/dashboard-content-template.html"},"section-info@home":{templateUrl:"app/dashboard/home/home-info-section.html"},"section-view@home":{templateUrl:"app/dashboard/home/home-view-section.html"},"section-commands@home":{templateUrl:"app/dashboard/home/home-commands-section.html"}}}).state("configuration-center",{url:"/project/configuration",resolve:{loggedUser:function(e){return e.loggedUser()},selectedProject:function(e){return e.selectedProject()},initialize:function(e){e.initialize()}},views:{"system-wrap":{templateUrl:n,controller:"DashboardMenuController as dashboardMenu"},"dashboard-menu@configuration-center":{templateUrl:o},"system-content@configuration-center":{templateUrl:"app/project/configuration/configuration-template.html",controller:"otusjs.otus-domain.project.configuration.ProjectConfigurationController",controllerAs:"configController"}}}).state("offline",{url:"/offline",views:{"system-wrap":{templateUrl:"app/response-error/offline/offline.html",controller:"ResponseErrorOfflineController as controller"}}}),t.otherwise("/login")}angular.module("otusDomain").config(["$stateProvider","$urlRouterProvider",e]).constant("APP_STATE",{LOGIN:"login",USER_REGISTER:"user-register",INSTALLER:"installer",HOME:"home",USER_ACTIVATION:"user-activation",USER_ACTIVATION_IN_PROJECT:"user-otus-management",PROJECT_CENTER:"field-center",PROJECT_ACTIVITY_CONFIGURATION:"activity_configuration",ACTIVITY_SETTINGS:"activity_settings",ERROR_OFFLINE:"offline",PROJECT_CONFIGURATION:"configuration-center",DATASOURCE_MANAGER:"datasource_manager",REPORT_MANAGER:"report_manager"}),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function e(e,t){e.theme("layoutTheme").primaryPalette("blue",{default:"A200","hue-1":"200"}).accentPalette("blue-grey",{default:"900","hue-1":"50"}).warnPalette("red"),t.defaultIconSet("app/assets/img/icons/mdi.svg",24)}angular.module("otusDomain").config(["$mdThemingProvider","$mdIconProvider",e])}(),function(){angular.module("otusDomain.installer",["passwordControl"])}(),function(){angular.module("otusDomain.project",["ngMaterial","ngSanitize"])}(),function(){angular.module("otusDomain.repository",[])}(),function(){angular.module("otusDomain.rest",[])}(),function(){angular.module("otusDomain.user",["otusDomain.user.management"])}(),function(){function e(e,t,o,n,r){e.authenticate=function(e){r.authenticate(e).then(function(){t.goToHome()},function(){n.show(n.simple().textContent("Login Inválido! Verifique os dados informados."))})},e.register=function(){t.goToUserRegister()}}angular.module("otusDomain.authenticator").controller("LoginController",e),e.$inject=["$scope","DashboardStateService","RestResourceService","$mdToast","UserService"]}(),angular.module("passwordControl",[]).directive("stPassword",function(){return{require:"ngModel",restrict:"A",link:function(e,t,o,n){var r=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])/;e.$watch(function(){return n.$modelValue},function(e){r.test(e)&&e.length>=6&&e.length<=32?n.$setValidity("passwordPattern",!0):n.$setValidity("passwordPattern",!1)})}}}).directive("stPasswordMatch",function(){return{require:"ngModel",restrict:"A",scope:{stPasswordMatch:"="},link:function(e,t,o,n){function r(e,t){e!==t?n.$setValidity("passwordMatch",!1):n.$setValidity("passwordMatch",!0)}e.$watch(function(){return e.stPasswordMatch},function(e){r(e,n.$modelValue)}),e.$watch(function(){return n.$modelValue},function(t){r(e.stPasswordMatch,t)})}}}),function(){angular.module("utils",[]).service("StringNormalizer",[function(){function e(e){for(var t=-1!==e.indexOf("-")?"-":".",o=e.split(t),n=o.length,r=o[0].toLowerCase(),i=1;i<n;i++){var a=o[i].slice(0,1),c=o[i].slice(1);r=r.concat(a.toUpperCase().concat(c.toLowerCase()))}return r}this.normalizeString=e}])}(),function(){function e(e,t,o,n,r){function i(){C.currentState="Login",e.go(o.LOGIN)}function a(){C.currentState="Instalador do Sistema",e.go(o.INSTALLER)}function c(){C.currentState="Cadastro de Usuário",e.go(o.USER_REGISTER)}function u(){C.currentState="Home",e.go(o.HOME)}function s(){C.currentState="Liberação de Usuários",e.go(o.USER_ACTIVATION)}function l(){C.currentState="Liberação de usuários no projeto selecionado",e.go(o.USER_ACTIVATION_IN_PROJECT)}function d(){C.currentState="Centros",e.go(o.PROJECT_CENTER)}function f(){C.currentState="Configurações de atividades",e.go(o.PROJECT_ACTIVITY_CONFIGURATION)}function m(){C.currentState="Configuração de atividade",e.go(o.ACTIVITY_SETTINGS)}function p(){C.currentState="Gerenciador de relatórios",e.go(o.REPORT_MANAGER)}function g(){C.currentState="Gerenciador de dados",e.go(o.DATASOURCE_MANAGER)}function v(){C.currentState="Configurações de Projeto",e.go(o.PROJECT_CONFIGURATION)}function h(){C.currentState="Offline",e.go(o.ERROR_OFFLINE)}function y(){n.getAuthenticatorResource().invalidate(function(){n.removeSecurityToken(),r.removeSecurityToken(),i()})}var C=this;C.goToLogin=i,C.goToHome=u,C.goToInstaller=a,C.goToUserRegister=c,C.goToUserActivation=s,C.goToUserActivationInProject=l,C.goToProjectCenters=d,C.goToProjectConfiguration=v,C.goToErrorOffline=h,C.goToProjectActivityConfiguration=f,C.goToActivitySettings=m,C.goToProjectReportManager=p,C.goToProjectDatasourceManager=g,C.logout=y,function(){C.currentState="Login"}()}angular.module("otusDomain.dashboard").service("DashboardStateService",e),e.$inject=["$state","$http","APP_STATE","RestResourceService","OtusRestResourceService"]}(),function(){function e(){}angular.module("otusDomain.dashboard").controller("HomeController",e),e.$inject=[]}(),function(){function e(e,t,o,n,r){function i(){return t.currentState}function a(){o("left").toggle()}function c(){o("left").close()}function u(){t.goToHome(),c()}function s(){t.goToSurveyForms(),c()}function l(){t.goToUserActivation(),c()}function d(){t.goToUserActivationInProject(),c()}function f(){t.goToProjectActivityConfiguration(),c()}function m(){t.goToProjectReportManager(),c()}function p(){t.goToProjectDatasourceManager(),c()}function g(){t.goToProjectCenters(),c()}function v(){t.goToProjectConfiguration(),c()}function h(){e.showDialog().onConfirm(t.logout)}var y=this;y.getSelectedSystemArea=i,y.open=a,y.close=c,y.openHome=u,y.openSurveyForms=s,y.openUserActivation=l,y.logout=h,y.openProjectCenters=g,y.openUserActivationInProject=d,y.openProjectConfiguration=v,y.openProjectActivityConfiguration=f,y.openReportManager=m,y.openDatasourceManager=p}angular.module("otusDomain.dashboard").controller("DashboardMenuController",e),e.$inject=["LogoutDialogService","DashboardStateService","$mdSidenav","ProjectSelectionService","ProjectContext"]}(),function(){function e(e,t,o,n,r,i){function a(e){o.isLoading=!0,v.config(e,function(e){e.data?u():c(e.MESSAGE),o.isLoading=!1})}function c(e){t.show(t.simple().textContent(y))}function u(){var e=n.alert().title("Informação").content(h).ok("ok");n.show(e).finally(function(){r.goToLogin()})}function s(e){v.validationEmail(e,function(e){f(e.data)})}function l(e){g.validateCredentials(e,function(e){m(e.data)})}function d(e){g.validateConnection(e,function(e){p(e.data)})}function f(e){o.initialConfigSystemForm.emailSenderEmail.$setValidity("emailService",e),o.initialConfigSystemForm.$setValidity("emailService",e)}function m(e){o.initialConfigSystemForm.repositoryUsername.$setValidity("credentials",e),o.initialConfigSystemForm.repositoryPassword.$setValidity("credentials",e),o.initialConfigSystemForm.$setValidity("credentials",e)}function p(e){o.initialConfigSystemForm.repositoryHost.$setValidity("connection",e),o.initialConfigSystemForm.repositoryPort.$setValidity("connection",e),o.initialConfigSystemForm.$setValidity("credentials",e)}self=this;var g,v,h="Seu cadastro foi realizado com sucesso! Você vai ser redirecionado para a tela de login.",y="Houve um erro ao instalar seu projeto. Verifique os dados informados";self.register=a,self.validateEmailService=s,self.validateCredentials=l,self.validateRepositoryConnection=d,self.validateEmailService=s,function(){g=i.getRepositoryResource(),v=i.getInstallerResource()}()}angular.module("otusDomain.installer").controller("InitialConfigController",e),e.$inject=["$q","$mdToast","$scope","$mdDialog","DashboardStateService","RestResourceService"]}(),function(){angular.module("otusDomain.project.configuration",[])}(),function(){function e(e){}angular.module("otusDomain.project.configuration").controller("otusjs.otus-domain.project.configuration.ProjectConfigurationController",e),e.$inject=["otusjs.otus-domain.project.configuration.ProjectConfigurationService"]}(),function(){function e(e,t){function o(){h=e.getConfigurationResource(),y=e.getProjectConfigurationResource(),C=e.getPermissionConfigurationResource(),j=e.getUserResource()}function n(){var e=t.defer();return j.list(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}function r(){var e=t.defer();return h.getSurveys(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}function i(e){var o=t.defer();return h.updateSurveyTemplateType({acronym:e.acronym,newSurveyFormType:e.type},function(e){e.data?o.resolve(!0):o.reject(!0)}),o.promise}function a(e){var o=t.defer();return h.deleteSurveyTemplate({acronym:e},function(e){e.data?o.resolve(!0):o.reject(!0)}),o.promise}function c(e){var o=t.defer();return h.publishTemplate(e,function(e){"data"in e?o.resolve(e.data):o.reject(e.MESSAGE)}),o.promise}function u(){var e=t.defer();return h.getVisualIdentity(function(t){e.resolve()}),e.promise}function s(e){var o=t.defer();return h.updateVisualIdentity(e,function(){o.resolve()}),o.promise}function l(){var e=t.defer();if(!y)throw new Error("REST resource is not initialized.");return y.getProjectConfiguration(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}function d(e){if(!y)throw new Error("REST resource is not initialized.");return y.allowNewParticipants({permission:e}).$promise}function f(e){if(!y)throw new Error("REST resource is not initialized.");return y.autoGenerateRecruitmentNumber({permission:e}).$promise}function m(){if(!j)throw new Error("REST resource is not initialized.");return j}function p(e){var o=t.defer();if(!C)throw new Error("REST resource is not initialized.");return C.create(e,function(){o.resolve()}),o.promise}function g(e){var o=t.defer();if(!C)throw new Error("REST resource is not initialized.");return C.update(e,function(){o.resolve()}),o.promise}function v(){var e=t.defer();if(!C)throw new Error("REST resource is not initialized.");return C.getAll(function(t){"data"in t?e.resolve(t.data):e.reject(!0)}),e.promise}var h,y,C,j,S=this;S.$onInit=o,S.fetchSurveysManagerConfiguration=r,S.publishTemplate=c,S.updateSurveyTemplateType=i,S.deleteSurveyTemplate=a,S.fetchProjectsVisualIdentity=u,S.updateVisualIdentityConfiguration=s,S.getProjectConfiguration=l,S.allowNewParticipants=d,S.autoGenerateRecruitmentNumber=f,S.getUserResource=m,S.setUsersExclusiveDisjunction=p,S.updateUsersExclusiveDisjunction=g,S.getCollectionOfPermissions=v,S.fetchUsers=n,o()}angular.module("otusDomain.project.configuration").service("otusjs.otus-domain.project.configuration.ProjectConfigurationService",e),e.$inject=["OtusRestResourceService","$q"]}(),function(){function e(){function e(e){return new t(e)}var o=this;return o.create=e,o}function t(e){var t=this,o=Object.freeze({id:void 0,name:void 0,data:void 0});return function(e){Object.assign(t,o,e)}(e),t}angular.module("otusDomain.project.datasource").factory("DatasourceFactory",e)}(),function(){function e(e,t,o){function n(){C.newDatasourceName="",a()}function r(){C.loadFile=!C.loadFile}function i(){return C.loadFile}function a(){e.getDatasourceList().then(function(e){C.ready=!0,C.datasources=e,0===C.datasources.length&&h("Nenhuma fonte de dados adicionado.")}).catch(function(e){h("Ocorreu um erro. Tente novamente mais tarde.")})}function c(e){e.type.match("csv")?C.isUpdate?u(e):(s(e),$("#newDatasourceName").focus()):h("Arquivo incompatível, o formato do arquivo deve ser csv.")}function u(o){C.isUpdate=!1;var n=new FormData;n.append("file",o),n.append("delimiter",y),n.append("id",C.id),n.append("name",C.name),e.updateDatasource(n).then(function(e){if(e.data)h("Dados salvo com sucesso.");else if(e.MESSAGE.includes("same"))h("Fonte de dados já existente, você tem a opção de editar caso desejar.");else if(e.MESSAGE.includes("missing"))h("Não foi possível atualizar a fonte de dados. Há elementos ausentes em comparação ao arquivo anterior.");else if(e.MESSAGE.includes("Data Validation Fail: ID")){var o=t.alert().title("Não foi possível salvar o datasource").content("Entre em contato com o suporte").ok("ok");t.show(o)}a()}).catch(function(e){h("Não foi possível salvar o datasource: "+e)})}function s(e){C.newDatasourceFile=e}function l(e){var t=event.keyCode,o=t>=97&&t<=122,n=t>=65&&t<=90,r=t>=48&&t<=57,i=95===t;o||n||r||i||e.preventDefault()}function d(){C.insertingNewDatasource=!0}function f(){delete C.newDatasourceFile,delete C.insertingNewDatasource}function m(){var o=new FormData;C.createFileName=C.newDatasourceName.replace(/\.csv/gi,"").replace(/ \([0-9]\)/gi,""),o.append("file",C.newDatasourceFile),o.append("delimiter",y),o.append("id",C.createFileName.toLowerCase()),o.append("name",C.createFileName.toUpperCase()),e.createDatasource(o).then(function(e){if(e.data)h("Dados salvo com sucesso.");else if(e.MESSAGE)if(e.MESSAGE.match("duplicated")){var o="";e.CONTENT.forEach(function(e){if(e.match("extraction")){var t=e.split(":");o=o.concat("Valor de extração: "+t[1].concat(" <br> "))}if(e.match("value")){var n=e.split(":");o=o.concat("Valor: "+n[1].concat(" <br> "))}});var n=t.alert().title("Existem elementos duplicados na fonte de dados: ").htmlContent(o).ok("ok");t.show(n).then(function(){})}else h("Fonte de dados já existente.");p(),a()}).catch(function(e){h("Não foi possível salvar o datasource: "+e),p()})}function p(){C.newDatasourceFile=null,C.insertingNewDatasource=!1,C.newDatasourceName=""}function g(e){C.id=e.id,C.name=e.name,C.isUpdate=!0}function v(e){var t=e.name;alasql('SELECT * INTO CSV("'+t+'.csv",{headers:false}) FROM ?',[e.data])}function h(e){o.show(o.simple().textContent(e).position("bottom left").hideDelay(3e3))}var y=";",C=this;C.ready=!1,C.loadFile=!1,C.isLoading=i,C.$onInit=n,C.exportDatasource=v,C.saveNewDatasource=m,C.updateAction=g,C.newDatasourceAction=d,C.datasourceNameFilter=l,C.cancelUpload=f,C.initLoadFile=r,C.isUpdate=!1,C.datasources=[],C.action={callback:c,type:".csv",loading:C.initLoadFile}}angular.module("otusDomain.project.datasource").component("datasourceManager",{controller:"datasourceManagerController as $ctrl",templateUrl:"app/project/datasource/datasource-manager-template.html"}).controller("datasourceManagerController",e),e.$inject=["DatasourceManagerService","$mdDialog","$mdToast"]}(),function(){function e(e,t,o){function n(){return e.list().then(function(e){return e.data.data.map(function(e){return t.create(e)})}).catch(function(e){throw e})}function r(t){return e.update(t).then(function(e){return e.data?e.data:o.reject(e.MESSAGE)}).catch(function(e){return o.reject(e)})}function i(t){return e.create(t).then(function(e){return e.data?e.data:o.reject(e.MESSAGE)}).catch(function(e){return o.reject(e)})}var a=this;a.getDatasourceList=n,a.updateDatasource=r,a.createDatasource=i,function(){e.initialize()}()}angular.module("otusDomain.project.datasource").service("DatasourceManagerService",e),e.$inject=["DatasourceRestService","DatasourceFactory","$q"]}(),function(){angular.module("otusDomain.project.datasource",[])}(),function(){function e(e){function t(e){return i.enableExtraction(e).$promise}function o(e){return i.disableExtraction(e).$promise}function n(e){return i.updateExtractionIps(e).$promise}var r=this,i=e.getExtractionResource();r.enableExtraction=t,r.disableExtraction=o,r.updateExtractionIps=n}angular.module("otusDomain.project").service("ExtractionRestService",e),e.$inject=["OtusRestResourceService"]}(),function(){function e(){function e(e){t.fieldCenters=e}var t=this;t.fieldCenters=[],t.setFieldCenters=e}angular.module("otusDomain.project.fieldCenter").service("ProjectFieldCenterContext",e)}(),function(){function e(e,t,o){function n(){s.showAddCenterTab=!1}function r(){return e.getCenters()}function i(e){e.editMode=!e.editMode}function a(e){s.showAddCenterTab=e}function c(t){e.update(t,function(e){e.hasErrors||o.show(o.simple().textContent(u))})}var u="Centro atualizado",s=this;s.centerAddAling="center center",s.centerAddheaderLabel="Novo Centro",s.getAllCenters=r,s.edit=i,s.update=c,s.showCreationTab=a,s.$onInit=n}angular.module("otusDomain.project.fieldCenter").controller("FieldCenterController",e),e.$inject=["ProjectFieldCenterService","$mdDialog","$mdToast"]}(),function(){angular.module("otusDomain.project.fieldCenter",[])}(),function(){function e(e,t){function o(){return t.fieldCenters}function n(){e.getOtusFieldCenterResource().getAll(function(e){t.setFieldCenters(e.data)},function(){t.setFieldCenters([])})}function r(t,o){e.getOtusFieldCenterResource().create(t,function(e){o(e)})}function i(t,o){delete t.editMode,e.getOtusFieldCenterResource().update(t,function(e){n(),o(e)})}var a=this;a.loadCenters=n,a.getCenters=o,a.create=r,a.update=i}angular.module("otusDomain.project.fieldCenter").service("ProjectFieldCenterService",e),e.$inject=["OtusRestResourceService","ProjectFieldCenterContext"]}(),function(){function e(e,t,o,n,r){function i(){h=e.getUserResource(),y=e.getOtusFieldCenterResource(),S=o.create(h),g(),d(),p()}function a(e){n.show(C).then(function(){e.enable?s(e):l(e)},function(){e.enable=!e.enable})}function c(e){n.show(j).then(function(){e.extraction?f(e):m(e)},function(){e.extraction=!e.extraction})}function u(e){S.updateFieldCenter(angular.toJson(e)).then(function(e){v("Centro atualizado.")})}function s(e){S.enable(e).then(function(e){v("Usuário habilitado.")})}function l(e){S.disable(e).then(function(t){e.extraction&&(e.extraction=!1,m(e)),v("Usuário desabilitado.")})}function d(){S.list().then(function(e){R.users=e.data})}function f(e){t.enableExtraction(e).then(function(e){v("Extração habilitada.")})}function m(e){t.disableExtraction(e).then(function(e){v("Extração desabilitada.")})}function p(){y.getAll(function(e){R.fieldCenters=e.data})}function g(){C=n.confirm().title(T).textContent(D).ok("Sim").cancel("Cancelar"),j=n.confirm().title(b).textContent(w).ok("Sim").cancel("Cancelar")}function v(e){r.show(r.simple().textContent(e))}var h,y,C,j,S,R=this,D="Você tem certeza que deseja alterar o status do usuário?",T="Mudança de Status",w="Você tem certeza que deseja alterar o status de Extração do usuário?",b="Mudança de Status para Extração de Dados";R.users=[],R.fieldCenters=[],R.$onInit=i,R.enableDisable=a,R.updateFieldCenter=u,R.enableDisableExtraction=c}angular.module("otusDomain.project").component("otusUser",{templateUrl:"app/project/otus-user/otus-user-template.html",controller:e}),e.$inject=["OtusRestResourceService","ExtractionRestService","UserManagerFactory","$mdDialog","$mdToast"]}(),function(){function e(){function e(e){return new t(e)}var o=this;return o.create=e,o}function t(e){function t(t){return e.enable(t).$promise}function o(t){return e.disable(t).$promise}function n(){return e.list().$promise}function r(t){return e.updateFieldCenter(t).$promise}var i=this;i.enable=t,i.disable=o,i.list=n,i.updateFieldCenter=r}angular.module("otusDomain.project").factory("UserManagerFactory",e)}(),function(){function e(){function e(){t.title=t.title||"",t.align=t.align||"center end",t.colorLeft=t.colorLeft||"#0092F8",t.colorRight=t.colorRight||"#4db5ff"}var t=this;t.$onInit=e}angular.module("otusDomain.project").component("otusPainel",{controller:e,templateUrl:"app/project/otus-painel/otus-painel-template.html",bindings:{headerLabel:"<",colorLeft:"<",colorRight:"<",align:"<"},transclude:!0})}(),function(){function e(){function e(e){return new o(e)}function n(e){try{return new o(t(e))}catch(e){throw"Erro ao processar arquivo"}}var r=this;return r.create=e,r.fromHtmlFile=n,r}function t(e){function t(e,t,o){return e.substring(e.lastIndexOf(t)+t.length,e.lastIndexOf(o))}return function(e){var o=t(e,"<otus-datasource>","</otus-datasource>"),n=JSON.parse(o);return n.template=e.replace("<otus-datasource>"+o+"</otus-datasource>",""),n}(e)}function o(e){function t(e){c=e,angular.extend(a,e)}function o(){angular.extend(a,c)}function n(){var e={};return Object.keys(c).forEach(function(t){e[t]=a[t]}),e.sendingDate=a.sendingDate?a.sendingDate:new Date,e}function r(){var e={};return Object.keys(u).forEach(function(t){e[t]=a[t]}),e.template="","<otus-datasource>\n"+JSON.stringify(e)+"\n</otus-datasource>"+a.template}function i(){return a._id.$oid}var a=this,c=e,u=Object.freeze({dataSources:void 0,fieldCenter:void 0,label:void 0,template:void 0});return a.sendingDate="",function(e){Object.assign(a,u,e)}(e),a.getId=i,a.refresh=t,a.reload=o,a.toJSON=n,a.toHtml=r,a}angular.module("otusDomain.dashboard").factory("ReportFactory",e)}(),function(){angular.module("otusDomain.dashboard").component("reportManager",{controller:"reportManagerController as $ctrl",templateUrl:"app/project/report/report-manager-template.html"})}(),function(){function e(e,t,o,n){function r(){y=o.getOtusFieldCenterResource(),m(),e.getReportList().then(function(e){C.ready=!0,C.reports=e,l()}).catch(function(e){C.error=!0})}function i(){C.reports=null}function a(t){e.uploadReport(t).then(function(e){C.reports.push(e),l(),v("Relatório salvo com sucesso.")}).catch(function(e){v("Não foi possível salvar o relatório: "+e)})}function c(o){t.show(g()).then(function(){e.updateReport(o).then(function(e){l(),v("Relatório alterado com sucesso.")}).catch(function(e){v("Erro ao atualizar: "+e)})}).catch(function(){o.reload(),v("Relatório não alterado!")})}function u(o,n){t.show(p()).then(function(){e.deleteReport(o).then(function(e){e&&C.reports.splice(n,1),l(),v("Relatório excluído com sucesso.")}).catch(function(e){v("Erro ao excluir: "+e)})}).catch(function(){d(),v("Relatório não excluído!!")})}function s(e){f("report.html",e.toHtml())}function l(){C.reportsOld=angular.copy(C.reports)}function d(){C.reports=angular.copy(C.reportsOld)}function f(e,t){var o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),o.setAttribute("download",e),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}function m(){y.getAll(function(e){C.fieldCenters=e.data})}function p(){return h=t.confirm().title("Exclusão de Relatório").textContent("Você tem certeza que deseja excluir esse Relatório?").ariaLabel("exclusão de relatório").ok("Sim").cancel("Não")}function g(){return h=t.confirm().title("Atualizar Relatório").textContent("Você tem certeza que deseja atualizar esse Relatório?").ariaLabel("atualização de relatório").ok("Sim").cancel("Não")}function v(e){n.show(n.simple().textContent(e).position("bottom left").hideDelay(3e3))}var h,y,C=this;C.ready=!1,C.error=!1,C.reports=[],C.reportsOld=[],C.uploadReport={callback:a,type:".html"},C.$onInit=r,C.$onDestroy=i,C.updateReport=c,C.deleteReport=u,C.exportReport=s}angular.module("otusDomain.dashboard").controller("reportManagerController",e),e.$inject=["ReportManagerService","$mdDialog","OtusRestResourceService","$mdToast"]}(),function(){function e(e,t,o){function n(){return e.list().then(function(e){return e.data.map(function(e){return t.create(e)})}).catch(function(e){throw e})}function r(n){try{var r=t.fromHtmlFile(n)}catch(e){return o.reject(e)}return e.create(r).then(function(e){return e.data?(r.refresh(e.data),r):o.reject(e.MESSAGE)}).catch(function(e){return o.reject(e)})}function i(t){return e.update(t).then(function(e){return e.data?(t.refresh(e.data),e.data):o.reject(e.MESSAGE)}).catch(function(e){return o.reject(e)})}function a(t){return e.remove(t.getId()).then(function(e){return e.data?e.data:o.reject(e.MESSAGE)}).catch(function(e){return o.reject(e)})}var c=this;c.getReportList=n,c.uploadReport=r,c.updateReport=i,c.deleteReport=a,function(){e.initialize()}()}angular.module("otusDomain.dashboard").service("ReportManagerService",e),e.$inject=["ReportRestService","ReportFactory","$q"]}(),function(){function e(e){function t(e){i.create(e,function(e){return!e.data.hasError})}function o(e){i.validateConnection(e,function(e){return e.data})}function n(e){i.getByRepositoryName({repositoryName:e.name},function(e){return e.data})}function r(e){i.validateCredentials(e,function(e){return e.data})}var i,a=this;a.createRepository=t,a.validateRepositoryConnection=o,a.validateIfRepositoryAlreadyExists=n,a.validateRepositoryCredentials=r,function(){i=e.getRepositoryResource()}()}angular.module("otusDomain.repository").service("RepositoryService",e),e.$inject=["RestResourceService"]}(),function(){function e(e,t){function o(){d=[]}function n(e){l=e,u()}function r(){return l}function i(){return null!==l}function a(n){o(),e.getOtusProjectResource().list(function(e){e.data.forEach(function(e,o,n){var r=e.projectName,i=e.projectRestUrl,a=e.projectToken,c=t.create(r,i,a);d.push(c)}),n(d)})}function c(e){f.push(e)}function u(){f.forEach(function(e){e(l)})}var s=this,l=null,d=[],f=[]
;s.setProject=n,s.hasProject=i,s.getCurrentProject=r,s.loadProjects=a,s.registerObserver=c}angular.module("otusDomain.project").service("ProjectContext",e),e.$inject=["RestResourceService","ProjectFactory"]}(),function(){function e(e,t,o){function n(t){e.setUrl(t.url),e.getOtusInstallerResource().ready(function(e){e.data?t.online():t.offline()},function(){t.offline()})}function r(o){var n=t.defer();e.setUrl(o.url);var r=o.getAuthentication();return e.getOtusAuthenticatorResource().authenticateProject(r,function(e){e.data?n.resolve(e):n.reject(e)}),n.promise}var i=this;i.isOnline=n,i.authenticate=r}angular.module("otusDomain.project").service("ProjectSecurityService",e),e.$inject=["OtusRestResourceService","$q","ProjectContext"]}(),function(){function e(e,t){function o(){e.hasProject()||n()}function n(){e.loadProjects(function(e){r(e)})}function r(e){t.show({controller:"ProjectChooseController as projectChoose",templateUrl:"app/project/selection/ui/dialog/project-choose-template.html",parent:angular.element(document.body),clickOutsideToClose:!0,fullscreen:!0,locals:{projects:e}})}var i=this;i.choose=n,i.initialChoose=o}angular.module("otusDomain.project").service("ProjectSelectionService",e),e.$inject=["ProjectContext","$mdDialog"]}(),function(){function e(e){e.interceptors.push("otusDomain.ResponseInterceptor")}angular.module("otusDomain").config(["$httpProvider",e])}(),function(){function e(e){function t(t){return e.get("DashboardStateService"),t}var o=this;return o.responseError=t,o}angular.module("otusDomain").factory("otusDomain.ResponseInterceptor",e),e.$inject=["$injector"]}(),function(){function e(e){function t(){e.goToLogin()}this.tryAgain=t}angular.module("otusDomain").controller("ResponseErrorOfflineController",e),e.$inject=["DashboardStateService"]}(),function(){function e(e,t,o,n){function r(t){var n=o.defer();return e.getAuthenticatorResource().authenticate(t,function(e){e.data?(c(e.data),n.resolve()):n.reject()}),n.promise}function i(){var t=o.defer();return e.getAuthenticatorResource().invalidate(function(){u(),t.resolve()},function(){t.reject()}),t.promise}function a(){n.reloadCurrentUser()}function c(t){e.setSecurityToken(t.token),n.setCurrentUser(t)}function u(){n.removeCurrentUser(),e.removeSecurityToken(),t.removeSecurityToken()}function s(){return n.getCurrentUser()}var l=this;l.getLoggedUser=s,l.authenticate=r,l.logout=i,l.reloadLoggedUser=a}angular.module("otusDomain.user").service("UserService",e),e.$inject=["RestResourceService","OtusRestResourceService","$q","UserContext"]}(),function(){function e(e){function t(){i.currentUser=null}function o(e){i.currentUser=e}function n(){return i.currentUser}function r(){if(e.isLogged()){e.getUserResource().current(function(e){o(e.data)})}}var i=this;i.currentUser=null,i.setCurrentUser=o,i.getCurrentUser=n,i.reloadCurrentUser=r,i.removeCurrentUser=t}angular.module("otusDomain.user").service("UserContext",e),e.$inject=["RestResourceService"]}(),function(){angular.module("otusDomain.user.management",["passwordControl"])}(),function(){function e(e){function o(){return e.show(i.dialogSettings).then(n,r),{onConfirm:function(e){i.callback=e}}}function n(e){"confirm"===e.action&&i.callback&&i.callback(e.data)}function r(e){}var i=this;i.showDialog=o,function(){i.dialogSettings={parent:angular.element(document.body),templateUrl:"app/dashboard/dialog/logout/logout-dialog.html",controller:t,controllerAs:"controller",openFrom:"#system-toolbar",closeTo:{bottom:0}}}()}function t(e){function t(t){e.hide(t)}function o(t){e.hide(t)}var n=this;n.cancel=t,n.confirm=o}angular.module("otusDomain.dashboard").service("LogoutDialogService",e),e.$inject=["$mdDialog"]}(),function(){function e(e,t,o,n){function r(){d(),i(),p=n.confirm().title("Exclusão de Formulário").textContent("Você tem certeza que deseja excluir esse Formulário?").ariaLabel("exclusão de formulário").ok("Sim").cancel("Não")}function i(){t.fetchSurveysManagerConfiguration().then(function(e){g.surveyTemplatesList=e,0===g.surveyTemplatesList.length?g.noListInfo="Nenhum formulário adicionado":g.noListInfo=""}).catch(function(){g.surveyTemplatesList=[],g.noListInfo="Erro de comunicação com servidor"})}function a(e){e.forEach(function(t){"json"===e[0].name.split(".")[1]&&c(t).then(function(e){g.uploadedObject=JSON.parse(e),g.uploadedFile=e,g.disableSaving=!1})})}function c(t){var o=e.defer(),n=new FileReader;return n.onload=function(){o.resolve(n.result)},n.readAsText(t),o.promise}function u(e){n.show(p).then(function(){t.deleteSurveyTemplate(g.surveyTemplatesList[e].surveyTemplate.identity.acronym).then(function(){g.surveyTemplatesList.splice(e,1),o.show(o.simple().textContent("Excluído").hideDelay(2e3))}).catch(function(){o.show(o.simple().textContent("Erro ao excluir").hideDelay(2e3))})},function(){})}function s(e){var n=g.surveyTemplatesList[e].surveyTemplate.identity.acronym,r=g.surveyTemplatesList[e].surveyFormType;t.updateSurveyTemplateType({acronym:n,type:r}).then(function(){o.show(o.simple().textContent("Alterado com sucesso").hideDelay(2e3))}).catch(function(){o.show(o.simple().textContent("Erro ao alterar.").hideDelay(2e3)),g.surveyTemplatesList[e].surveyFormType="PROFILE"===r?"FORM_INTERVIEW":"PROFILE"})}function l(){t.publishTemplate(g.uploadedFile).then(function(e){f(e)}).catch(function(e){m(e)})}function d(){t.getCollectionOfPermissions().then(function(e){g.permissionList=angular.copy(e)})}function f(e){g.uploadedObject={},g.uploadedFile={},g.disableSaving=!0,g.surveyTemplatesList.push(e),o.show(o.simple().textContent("Upload realizado com sucesso"))}function m(e){var t="";switch(e){case"Acronym Already Exists":t+="Já existe um formulário com esta sigla";break;case"ID Already Exists":t+="Ids de questões conflitam com as de formulários já existentes";break;default:t+="Erro ao enviar"}o.show(o.simple().textContent(t).hideDelay(2e3))}var p,g=this;g.$onInit=r,g.surveyTemplatesList=[],g.permissionList=[],g.usersList=[],g.publishTemplate=l,g.updateSurveyFormType=s,g.deleteSurveyTemplate=u,g.uploadConfig={callback:a,type:"json"},g.uploadedObject={},g.uploadedFile={},g.disableSaving=!0}angular.module("otusDomain.dashboard").component("activityConfiguration",{controller:"activityConfigurationCtrl as $ctrl",templateUrl:"app/project/configuration/activity/activity-configuration-template.html"}).controller("activityConfigurationCtrl",e),e.$inject=["$q","otusjs.otus-domain.project.configuration.ProjectConfigurationService","$mdToast","$mdDialog"]}(),function(){function e(){function e(){n.selectSurveyToSettings=null}function t(){return n.selectSurveyToSettings||null}function o(e){n.selectSurveyToSettings=e}var n=this;n.$onInit=e,n.getSurveyToSettings=t,n.setSurveyToSettings=o}angular.module("otusDomain.dashboard").service("ActivityConfigurationManagerService",e),e.$inject=[]}(),function(){function e(e,t,o){function n(){r()}function r(){o.getProjectConfiguration().then(function(e){s.participantRegistration=e.participantRegistration,s.autoGenerateRecruitmentNumber=e.autoGenerateRecruitmentNumber}).catch(function(){s.error=!0,t.show(t.simple().textContent(c).hideDelay(5e3))})}function i(){s.participantRegistration?o.allowNewParticipants(!0).then(function(e){s.participantRegistration=!0,t.show(t.simple().textContent(u).hideDelay(5e3))}).catch(function(){t.show(t.simple().textContent(c).hideDelay(5e3))}):o.allowNewParticipants(!1).then(function(e){s.participantRegistration=!1,t.show(t.simple().textContent(u).hideDelay(5e3))}).catch(function(){t.show(t.simple().textContent(c).hideDelay(5e3))})}function a(){s.autoGenerateRecruitmentNumber?o.autoGenerateRecruitmentNumber(!0).then(function(e){s.autoGenerateRecruitmentNumber=!0,t.show(t.simple().textContent(u).hideDelay(5e3))}).catch(function(){t.show(t.simple().textContent(c).hideDelay(5e3))}):o.autoGenerateRecruitmentNumber(!1).then(function(e){s.autoGenerateRecruitmentNumber=!1,t.show(t.simple().textContent(u).hideDelay(5e3))}).catch(function(){t.show(t.simple().textContent(c).hideDelay(5e3))})}var c="Erro de comunicação com servidor",u="Alteração realizada com sucesso",s=this;s.participantRegistration,s.autoGenerateRecruitmentNumber,s.error,s.$onInit=n,s.setAllowNewParticipants=i,s.setAutoGenerateRecruitmentNumber=a}angular.module("otusDomain.project.configuration").component("otusParticipantRegistration",{controller:"otusParticipantRegistrationCtrl as $ctrl",templateUrl:"app/project/configuration/participant-registration/participant-registration-template.html"}).controller("otusParticipantRegistrationCtrl",e),e.$inject=["$q","$mdToast","otusjs.otus-domain.project.configuration.ProjectConfigurationService"]}(),function(){function e(e){function t(t,o,n){function r(t){var o=e.uploadTypeResolver(t);return""!==o?(i=document.createElement("input"),i.setAttribute("type","file"),i.setAttribute("accept",o)):i=document.createElement("button"),i}var i,a=t.uploadTool,c=a.callback||{},u=a.type||"any";o.on("click",function(e){i=r(u),i.click(),i.addEventListener("change",function(){for(var e=[],t=0;t<this.files.length;t++)e.push(this.files[t]);0!==e.length&&c(e)})})}return{restrict:"A",link:t,scope:{uploadTool:"="}}}angular.module("otusDomain.project.configuration").directive("uploadTool",e),e.$inject=["otusjs.otus-domain.project.configuration.UploadToolService"]}(),function(){function e(){function e(e){var o="";if(e){e=e.replace(/\s/g,"").split(",");for(var n=0;n<e.length;n++){var r=t(e[n]);r&&(o+=r+", ")}}return o||"any"}function t(e){return{image:"image/*",jpg:".jpg",png:".png",json:".json"}[e]}this.uploadTypeResolver=e}angular.module("otusDomain.project.configuration").service("otusjs.otus-domain.project.configuration.UploadToolService",e),e.$inject=[]}(),function(){function e(){function e(e,t){function o(){return n=document.createElement("input"),n.setAttribute("type","file"),n.setAttribute("accept",a),n}var n,r=e.datasourceUpload,i=r.callback||{},a=r.type||"any";t.on("click",function(){n=o(),n.click(),n.addEventListener("change",function(t){e.datasourceUpload.loading();for(var o=t.target.files,n=0;n<o.length;n++){var r=o[n];i(r,t)}e.datasourceUpload.loading()})})}return{restrict:"A",link:e,scope:{datasourceUpload:"="}}}angular.module("otusDomain.project.datasource").directive("datasourceUpload",e)}(),function(){function e(e,t,o,n){function r(){m.fieldCenter={},m.fieldCenter.backgroundColor="rgba(54, 162, 235, 1)",m.fieldCenter.borderColor="rgba(54, 162, 235, 1)"}function i(){o.create(m.fieldCenter,function(e){e.CONTENT&&!1===e.CONTENT.valid?(a(m.fieldCenter),e.CONTENT.conflicts.forEach(function(e){switch(e){case"acronym":t.createForm.acronym.$setValidity("ACRONYM_EXIST",!1);break;case"code":t.createForm.code.$setValidity("CODE_EXIST",!1)}})):(s(),o.loadCenters(),m.showTab=!1,reset())})}function a(){n.show(n.simple().textContent(f))}function c(){t.createForm.acronym.$setValidity("ACRONYM_EXIST",!0)}function u(){t.createForm.code.$setValidity("CODE_EXIST",!0)}function s(){n.show(n.simple().textContent(d))}function l(){m.fieldCenter=angular.copy({})}var d="Centro Adicionado com Sucesso",f="Dados Invalidos",m=this;m.$onInit=r,m.create=i,m.cleanFields=l,m.resetValidation=c,m.resetValidationCode=u}angular.module("otusDomain.project.fieldCenter").component("centerCard",{controller:e,templateUrl:"app/project/fieldCenter/center-card/center-card-template.html",bindings:{showTab:"="}}),e.$inject=["DashboardStateService","$scope","ProjectFieldCenterService","$mdToast"]}(),function(){angular.module("otusDomain.project").directive("numbersOnly",function(){return{require:"ngModel",link:function(e,t,o,n){function r(e){if(e){var t=String(e),o=t.replace(/[^0-9|\r|\n]/g,"");return o!==t&&(n.$setViewValue(o),n.$render()),String(o)}}n.$parsers.push(r)}}})}(),function(){function e(e,t,o,n){function r(){l.cloneExtractionIps=angular.copy(l.user.extractionIps),c()}function i(){t.show(s).then(function(){l.cloneExtractionIps=angular.copy(l.user.extractionIps),a(),n.find("#userIp"+l.userIndex).focus()},function(){l.user.extractionIps=angular.copy(l.cloneExtractionIps),n.find("#userIp"+l.userIndex).focus()})}function a(){e.updateExtractionIps(l.user).then(function(e){u("Ip(s) atualizado(s).")})}function c(){s=t.confirm().title(d).textContent(f).ok("Sim").cancel("Cancelar")}function u(e){o.show(o.simple().textContent(e))}var s,l=this,d="Alteração nos IPs de extração",f="Você tem certeza que deseja alterar os IPs de Extração do usuário?";l.$onInit=r,l.onIpChange=i}angular.module("otusDomain.project").component("extractiosIpsField",{templateUrl:"app/project/otus-user/extraction-ips-field/extraction-ips-field-teamplate.html",controller:e,bindings:{user:"=",userIndex:"<"}}),e.$inject=["ExtractionRestService","$mdDialog","$mdToast","$element"]}(),function(){function e(){function e(e,t,o){function n(){return r=document.createElement("input"),r.setAttribute("type","file"),r.setAttribute("accept",c),r}var r,i=e.reportTemplateUpload,a=i.callback||{},c=i.type||"any";t.on("click",function(){r=n(),r.click(),r.addEventListener("change",function(e){for(var t=e.target.files,o=0;o<t.length;o++){var n=t[o];if(n.type.match("html")){var r=new FileReader;r.addEventListener("load",function(e){var t=e.target;a(t.result)}),r.readAsText(n)}}})})}return{restrict:"A",link:e,scope:{reportTemplateUpload:"="}}}angular.module("otusDomain.dashboard").directive("reportTemplateUpload",e)}(),function(){function e(e){function o(o,n,r){return new t(o,n,e.getLoggedUser().email,r)}var n=this;return n.create=o,n}function t(e,t,n,r){function i(){return l}function a(){s.status=!0}function c(){s.status=!1}function u(e){s.status=e}var s=this,l=new o(n,r);s.name=e,s.url=t,s.status=!1,s.getAuthentication=i,s.online=a,s.offline=c,s.changeStatus=u}function o(e,t){var o=this;o.user=e,o.accessToken=t}angular.module("otusDomain.project").factory("ProjectFactory",e),e.$inject=["UserService"]}(),function(){function e(e){function t(t){e.registerObserver(function(e){e?t.show():t.hide()})}return{retrict:"A",controller:function(e,o,n){e.hasProject()?n.show():n.hide(),t(n)}}}angular.module("otusDomain.project").directive("otusWaitingProject",e),e.$inject=["ProjectContext"]}(),function(){function e(e,t){function o(){s=t.getActivityConfigurationResource()}function n(e){if(!s)throw new Error("REST resource is not initialized.");return s.update(e).$promise}function r(e){if(!s)throw new Error("REST resource is not initialized.");return s.create({label:e}).$promise}function i(e){if(!s)throw new Error("REST resource is not initialized.");return s.setDefault({id:e.name}).$promise}function a(){if(!s)throw new Error("REST resource is not initialized.");var t=e.defer();return s.listAll().$promise.then(function(e){e.data&&e.data.length?t.resolve(e.data):t.resolve([])}),t.promise}function c(e){if(!s)throw new Error("REST resource is not initialized.");return s.delete({id:e.name}).$promise}var u=this,s=null;u.initialize=o,u.update=n,u.setDefault=i,u.list=a,u.save=r,u.remove=c}angular.module("otusDomain").service("ActivityConfigurationRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e,t){function o(){i=t.getActivityResource()}function n(e){if(!i)throw new Error("REST resource is not initialized.");return i.getById({id:e}).$promise}var r=this,i=null;r.initialize=o,r.getById=n}angular.module("otusDomain").service("ActivityRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e){function t(){c=e.getDatasourceResourceFactory()}function o(e){if(!c)throw new Error("REST resource is not initialized.");return c.create(e)}function n(e){if(!c)throw new Error("REST resource is not initialized.");return c.update(e)}function r(){if(!c)throw new Error("REST resource is not initialized.");return c.list()}function i(e){if(!c)throw new Error("REST resource is not initialized.");return c.getById(e)}var a=this,c=null;a.initialize=t,a.create=o,a.update=n,a.list=r,a.getById=i}angular.module("otusDomain.rest").service("DatasourceRestService",e),e.$inject=["OtusRestResourceService"]}(),function(){function e(e,t){function o(){s=t.getReportResourceFactory()}function n(e){if(!s)throw new Error("REST resource is not initialized.");return s.create(e).$promise}function r(){if(!s)throw new Error("REST resource is not initialized.");return s.listAll().$promise}function i(e){if(!s)throw new Error("REST resource is not initialized.");return s.update(e).$promise}function a(e){if(!s)throw new Error("REST resource is not initialized.");return s.getById({id:e}).$promise}function c(e){if(!s)throw new Error("REST resource is not initialized.");return s.remove({id:e}).$promise}var u=this,s=null;u.initialize=o,u.update=i,u.getById=a,u.list=r,u.create=n,u.remove=c}angular.module("otusDomain").service("ReportRestService",e),e.$inject=["$q","OtusRestResourceService"]}(),function(){function e(e,t,o){function n(e){e.enable?i(e):a(e)}function r(e){var o=t.confirm().title(d).textContent(l).ok("Sim").cancel("Cancelar");t.show(o).then(function(){n(e)},function(){e.enable=!e.enable})}function i(e){u.enable(e,function(){o.show(o.simple().textContent("Usuário habilitado."))})}function a(e){u.disable(e,function(){o.show(o.simple().textContent("Usuário desabilitado."))})}function c(){u.list(function(e){s.users=e.data})}var u,s=this,l="Você tem certeza que deseja alterar o status do usuário ?",d="Mudança de Status";s.users=[],s.confirmDialog=r,function(){u=e.getUserResource(),c()}()}angular.module("otusDomain.user.management").controller("UserActivationController",e),e.$inject=["RestResourceService","$mdDialog","$mdToast"]}(),function(){function e(e,t,o,n){function r(e){n.getUserResource().create(e,function(e){e.data&&a()})}function i(){o.goToLogin()}function a(){var e=t.alert().title("Informação").content(c).ok("ok");t.show(e).finally(function(){o.goToLogin()})}var c="Sua liberação está pendente de aprovação.",u=this;u.register=r,u.back=i}angular.module("otusDomain.user.management").controller("UserRegisterController",e),e.$inject=["$http","$mdDialog","DashboardStateService","RestResourceService"]}(),function(){angular.module("otusDomain.user.management").directive("unique",["$http","$q","RestResourceService",function(e,t,o){return{restrict:"A",require:"ngModel",link:function(e,n,r,i){i.$asyncValidators.emailInUse=function(e){var n=t.defer();return o.getUserResource().exist({email:e},function(e){e.data?n.reject():n.resolve()}),n.promise}}}}])}(),function(){function e(e,t){function o(){r()}function n(){a.newCategoryLabel?t.save(a.newCategoryLabel).then(function(e){a.newCategoryLabel="",a.categories.push(e.data)}):i()}function r(){t.list().then(function(e){a.categories=e})}function i(){e.show(e.simple().textContent("A label não pode ser vazia").hideDelay(2e3))}var a=this;a.newCategoryLabel="",a.$onInit=o,a.newCategory=n,a.listCategories=r}angular.module("otusDomain.dashboard").component("activityCategoryConfiguration",{controller:e,templateUrl:"app/project/configuration/activity/category/category-configuration-template.html"}),e.$inject=["$mdToast","ActivityConfigurationRestService"]}(),function(){function e(e,t,o,n,r,i){function a(){g.permissionList=[],d(),l(),g.permission=n.fromJsonObject({acronym:g.surveyForm.surveyTemplate.identity.acronym,version:g.surveyForm.version})}function c(){s(),i.setSurveyToSettings(g.permission),r.goToActivitySettings()}function u(){t.show(f).then(function(){var t=g.surveyTemplates.indexOf(g.surveyForm);e.deleteSurveyTemplate(g.surveyForm.surveyTemplate.identity.acronym).then(function(){g.surveyTemplates.splice(t,1),o.show(o.simple().textContent("Excluído").hideDelay(2e3))}).catch(function(){o.show(o.simple().textContent("Erro ao excluir").hideDelay(2e3))})},function(){})}function s(){g.permissionList.forEach(function(e){e.acronym===g.surveyForm.surveyTemplate.identity.acronym&&e.version==g.surveyForm.version&&(g.permission=n.fromJsonObject(e))})}function l(){e.getCollectionOfPermissions().then(function(e){g.permissionList=e}).catch(function(){o.show(o.simple().textContent(m).hideDelay(p))})}function d(){f=t.confirm().title("Exclusão de Formulário").textContent("Você tem certeza que deseja excluir esse Formulário?").ariaLabel("exclusão de formulário").ok("Sim").cancel("Não")}var f,m="Ocorreu algum problema, tente novamente mais tarde",p=5e3,g=this;g.showSettings,g.usersList=[],g.$onInit=a,g.showActivitySettings=c,g.deleteSurveyTemplate=u}angular.module("otusDomain.dashboard").component("surveyTemplateConfiguration",{controller:"surveyTemplateConfigurationCtrl as $ctrl",templateUrl:"app/project/configuration/activity/survey-template/survey-template-configuration-template.html",bindings:{surveyForm:"<",surveyTemplates:"="}}).controller("surveyTemplateConfigurationCtrl",e),e.$inject=["otusjs.otus-domain.project.configuration.ProjectConfigurationService","$mdDialog","$mdToast","otusjs.model.activity.ActivityPermissionFactory","DashboardStateService","ActivityConfigurationManagerService"]}(),function(){function e(e,t,o,n){function r(){h.users=[],h.AllUsers=[],h.permission=o.getSurveyToSettings(),e.fetchUsers().then(function(e){d(e),h.permission.exclusiveDisjunction.forEach(function(e){h.AllUsers.forEach(function(t){t.email===e&&h.users.push(t)})})})}function i(e,o){t.show(t.simple().textContent(e).position("right bottom").hideDelay(o))}function a(t){h.permission._id?e.updateUsersExclusiveDisjunction(h.permission).then(function(e){i(t,v)}).catch(function(e){i("Não foi possível atualizar configurações",v)}):e.setUsersExclusiveDisjunction(h.permission).then(function(o){e.getCollectionOfPermissions().then(function(e){h.permissionList=angular.copy(e),c()}),i(t,v)}).catch(function(e){i("Não foi possível atualizar configurações",v)})}function c(){h.permissionList.forEach(function(e){e.acronym===h.permission.acronym&&e.version==h.permission.version&&(h.permission=n.fromJsonObject(e))})}function u(e){return angular.isObject(e)?e:{name:e,type:"new"}}function s(e){h.permission.addUser(e.email),a(p)}function l(e){h.permission.removeUser(e.email),a(g)}function d(e){e.forEach(function(e){h.AllUsers.push({name:e.name,email:e.email})})}function f(e){return e?h.AllUsers.filter(m(e)):[]}function m(e){var t=e.toLowerCase();return function(e){return-1!==e.name.toLowerCase().indexOf(t)}}var p="Usuário adicionado com sucesso.",g="Usuário removido com sucesso.",v=2e3,h=this;h.surveyTemplatesList=[],h.usersList=[],h.$onInit=r,h.querySearch=f,h.saveSettings=a,h.transformChip=u,h.onAdd=s,h.onRemove=l}angular.module("otusDomain.dashboard").component("activitySettings",{controller:"activitySettingsCtrl as $ctrl",templateUrl:"app/project/configuration/activity/settings/activity-settings-template.html"}).controller("activitySettingsCtrl",e),e.$inject=["otusjs.otus-domain.project.configuration.ProjectConfigurationService","$mdToast","ActivityConfigurationManagerService","otusjs.model.activity.ActivityPermissionFactory"]}(),function(){function e(e,t,o){function n(){var t=e.defer();return t.resolve(!0),t.promise}function r(){n().then(function(e){e.files?f.data=e:f.data={files:{logoURL:m,bannerURL:m},date:""}}).finally(function(){f.changed=!1})}function i(e){f.progressBanner=!0,c(e).then(function(e){f.data.files.bannerURL=e,f.changed=!0,f.progressBanner=!1})}function a(e){f.progressLogo=!0,c(e).then(function(e){f.data.files.logoURL=e,f.changed=!0,f.progressLogo=!1})}function c(t){var o=e.defer(),n=new FileReader;return n.onload=function(){o.resolve(n.result)},n.readAsDataURL(t[0]),o.promise}function u(){f.changed=!1;var e={files:{logo:f.data.files.logoURL,banner:f.data.files.bannerURL},sendingDate:new Date};t.updateVisualIdentityConfiguration(e,s,l)}function s(){f.data.sendingDate=d(new Date),o.show(o.simple().textContent("Salvo com sucesso"))}function l(){o.show(o.simple().textContent("Falha ao atualizar imagem")),r()}function d(e){return e.toLocaleDateString()+" - "+e.toLocaleTimeString()}var f=this;(function(){r()})(),f.progressBanner=!1,f.progressLogo=!1,f.uploadBanner={callback:i,type:"image"},f.uploadLogo={callback:a,type:"image"},f.save=u;var m="app/assets/img/image_not_found.jpg"}angular.module("otusDomain.project.configuration").component("otusVisualIdentity",{templateUrl:"app/project/configuration/config-components/project-visual-identity-component/project-visual-identity-template.html",controller:e}),e.$inject=["$q","otusjs.otus-domain.project.configuration.ProjectConfigurationService","$mdToast"]}(),function(){function e(e,t){function o(o,n,r){o.project=t.getCurrentProject(),o.chooseProject=function(){e.choose()},o.hasProject=function(){return t.hasProject()},t.registerObserver(function(e){o.project=e})}return{templateUrl:"app/project/selection/ui/toolbar/otus-project-selection-toolbar.html",restrict:"E",link:o}}angular.module("otusDomain.project").directive("otusProjectSelection",e),e.$inject=["ProjectSelectionService","ProjectContext"]}(),function(){function e(e,t,o,n,r,i,a){function c(){t.cancel()}function u(e){e.forEach(function(e){n.isOnline(e)})}function s(e){e.status?n.authenticate(e).then(function(t){d(t.data,e),c()},function(){l(),m()}):f()}function l(){if(i.hasProject()){var e=i.getCurrentProject();a.setUrl(e.projectRestUrl),a.setSecurityToken(e.sessionToken)}}function d(e,t){t.sessionToken=e,a.setSecurityToken(t.sessionToken),i.setProject(t)}function f(){r.show(r.simple().textContent(p))}function m(){r.show(r.simple().textContent(g))}var p="Projeto Offline. Verifique o estado do projeto.",g="Erro ao realizar autenticação no projeto",v=this;v.projects=o,v.close=c,v.select=s,function(){u(v.projects),l()}()}angular.module("otusDomain.project").controller("ProjectChooseController",e),e.$inject=["$scope","$mdDialog","projects","ProjectSecurityService","$mdToast","ProjectContext","OtusRestResourceService"]}(),function(){function e(e,t,o){function n(){s()}function r(){f.onUpdate=!0}function i(){f.categoryData.label?o.update(f.categoryData).then(function(){f.onUpdate=!1,d.textContent("A categoria "+f.categoryData.label+" sera removida")}):l()}function a(){f.categoryData.isDefault?(f.categoryData.isDefault=1,u()):o.setDefault(f.categoryData).then(function(){f.reloadCategories()})}function c(){f.categoryData.isDefault?u():t.show(d).then(function(){o.remove(f.categoryData).then(function(){f.reloadCategories()})})}function u(){e.show(e.simple().textContent("Uma nova categoria padrão deve ser definida").hideDelay(2e3))}function s(){d=t.confirm().title("Confirmar remoção:").textContent("A categoria "+f.categoryData.label+" sera removida").ariaLabel("Confirmação de remoção").ok("Ok").cancel("Voltar")}function l(){e.show(e.simple().textContent("A label não pode ser vazia").hideDelay(2e3))}var d,f=this;f.onUpdate=!1,f.$onInit=n,f.categoryUpdate=r,f.saveCategory=i,f.removeCategory=c,f.saveDefault=a}angular.module("otusDomain.dashboard").component("categoryEdit",{controller:e,templateUrl:"app/project/configuration/activity/category/category-edit/category-edit-template.html",bindings:{categoryData:"<",reloadCategories:"&"}}),e.$inject=["$mdToast","$mdDialog","ActivityConfigurationRestService"]}();